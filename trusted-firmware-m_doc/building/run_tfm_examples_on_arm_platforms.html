<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Run TF-M tests and applications on Arm platforms &mdash; Trusted Firmware-M v2.1.0-stm32mp-r1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tfm_custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Documentation generation" href="documentation_generation.html" />
    <link rel="prev" title="Build Tests" href="tests_build_instruction.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Trusted Firmware-M
              <img src="../_static/tf_logo_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v2.1.0-stm32mp-r1

              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../security/threat_models/generic_threat_model.html">Threat model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/security_advisories/index.html">Security Advisories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/stack_seal_vulnerability.html">Advisory TFMV-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/svc_caller_sp_fetching_vulnerability.html">Advisory TFMV-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/crypto_multi_part_ops_abort_fail.html">Advisory TFMV-3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/profile_small_key_id_encoding_vulnerability.html">Advisory TFMV-4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/fwu_write_vulnerability.html">Advisory TFMV-5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/cc3xx_partial_tag_compare_on_chacha20_poly1305.html">Advisory TFMV-6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/debug_log_vulnerability.html">Advisory TFMV-7</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Releases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../releases/2.1.0.html">v2.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/2.0.0.html">v2.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/1.8.1.html">v1.8.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/1.8.0.html">v1.8.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/release_process.html">Release Cadence and Process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../platform/index.html">Platforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../platform/arm/index.html">Arm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/corstone1000/readme.html">Corstone-1000</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/mps3/corstone300/README.html">Corstone-300 FPGA (AN547 and AN552) and FVP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/mps3/corstone310/README.html">Corstone-310 FPGA (AN555) and FVP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/mps4/corstone315/README.html">Corstone-315 FVP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/musca_b1/readme.html">Musca-B1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/musca_s1/readme.html">Musca-S1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/rse/index.html">Runtime Security Engine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/armchina/index.html">ArmChina</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/armchina/mps3/alcor/README.html">Alcor FPGA (AN557)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/cypress/index.html">Cypress</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/cypress/psoc64/index.html">PSoC64</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/lairdconnectivity/index.html">Laird Connectivity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/lairdconnectivity/bl5340_dvk_cpuapp/README.html">BL5340</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/nordic_nrf/index.html">Nordic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/nordic_nrf/nrf5340dk_nrf5340_cpuapp/README.html">nRF5340</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/nordic_nrf/nrf9160dk_nrf9160/README.html">nRF9160</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/nordic_nrf/nrf9161dk_nrf9161/README.html">nRF9161</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/nuvoton/index.html">Nuvoton</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/nuvoton/m2351/README.html">NuMaker-PFM-M2351</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/nuvoton/m2354/README.html">NuMaker-PFM-M2354</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/nxp/index.html">NXP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/nxp/lpcxpresso55s69/README.html">LPCXpresso55S69</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/stm/index.html">STMICROELECTRONICS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32h5xx/readme.html">STM32H5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32l5xx/readme.html">STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32mp2xx/readme.html">STM32MP2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32u5xx/readme.html">STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO_L552ZE_Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32h573i_dk/readme.html">STM32H573I_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32l562e_dk/readme.html">STM32L562E_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp215f_dk/readme.html">stm32mp215f_dk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/b_u585i_iot02a/readme.html">B_U585I_IOT02A</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="tfm_build_instruction.html">Build instructions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tests_build_instruction.html">Build Tests</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Run TF-M tests and applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="documentation_generation.html">Building the documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tfm_build_instruction_iar.html">IAR toolchain</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration/build_configuration.html">Build configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/header_file_system.html">Component configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/kconfig_system.html">Kconfig</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/profiles/index.html">Profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_small.html"> Small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_medium_arot-less.html"> ARoT-less</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_medium.html"> Medium</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_large.html"> Large</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/test_configuration.html">Tests configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../integration_guide/index.html">Integration Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/source_structure/source_structure.html">Source Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/source_structure/platform_folder.html">Details for the /platform folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/source_structure/platform_ext_folder.html">Details for the /platform/ext folder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/spm_backends.html">SPM Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/non-secure_client_extension_integration_guide.html">NS client integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/os_migration_guide_armv8m.html">OS migration to Armv8-M</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/tfm_fpu_support.html">Floating-Point Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/tfm_secure_irq_integration_guide.html">Secure Interrupt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/platform_provisioning.html">Platform Provisioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/platform/index.html">Adding a new platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/platform/porting_tfm_to_a_new_hardware.html">Porting TF-M to a New Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/platform/documenting_platform.html">Platform Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/platform/platform_deprecation.html">Platform deprecation and removal</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/services/index.html">Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_attestation_integration_guide.html">Initial Attestation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_crypto_integration_guide.html">Crypto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_its_integration_guide.html">Internal Trusted Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_platform_integration_guide.html">Platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_ps_integration_guide.html">Protected Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_secure_partition_addition.html">Adding a New Secure Partition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_manifest_tool_user_guide.html">Manifest Tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_adac_integration_guide.html">ADAC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../design_docs/index.html">Design Documents</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/booting/tfm_secure_boot.html">Secure Boot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/booting/bl1.html">BL1 Immutable bootloader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/booting/secure_boot_rollback_protection.html">Rollback Protection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/booting/secure_boot_hw_key_integration.html">HW Key integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/dual-cpu/index.html">Dual CPU</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/dual-cpu/booting_a_dual_core_system.html">Booting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/dual-cpu/communication_prototype_between_nspe_and_spe_in_dual_core_systems.html">SPE - NSPE communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/dual-cpu/mailbox_design_on_dual_core_system.html">Mailbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/dual-cpu/mailbox_ns_agent_update.html">Mailbox update</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/dual-cpu/tfm_multi_core_access_check.html">Memory Access Check</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/services/index.html">Secure Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/secure_partition_manager.html">Secure Partition Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/secure_partition_runtime_library.html">Secure Partition RTL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/tfm_psa_inter_process_communication.html">Inter-Process Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/stateless_rot_service.html">Stateless Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/tfm_uniform_secure_service_signature.html">Service Signing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/tfm_crypto_design.html">Crypto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/symmetric_initial_attest.html">Initial Attestation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/tfm_its_service.html">Internal Trusted Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/tfm_fwu_service.html">Firmware Update</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/ps_key_management.html">PS Key Management</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/software/index.html">Software Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/software/code_sharing.html">Code Sharing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/software/hardware_abstraction_layer.html">Hardware Abstraction Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/software/tfm_cooperative_scheduling_rules.html">Cooperative Scheduling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/software/tfm_code_generation_with_jinja2.html">Code Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/software/enum_implicit_casting.html">Implicit Typecasting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/ff_isolation.html">Isolation Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/tfm_builtin_keys.html">Builtin Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/tfm_log_system_design_document.html">Logging system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/tfm_physical_attack_mitigation.html">Physical Attack Mitigation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Guidelines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/contributing_process.html">The process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/code_review_guide.html">Code review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/maintainers.html">Maintainers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/maintainers.html#code-owners">Code owners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/coding_guide.html">Yet another coding standard :)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/doc_guidelines.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/tfm_design_proposal_guideline.html">Design proposal</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/lic.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/dco.html">DCO</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://trustedfirmware-m.readthedocs.io/projects/tf-m-tests/en/latest/">TF-M Tests</a></li>
<li class="toctree-l1"><a class="reference external" href="https://trustedfirmware-m.readthedocs.io/projects/tf-m-tools/en/latest/">TF-M Tools</a></li>
<li class="toctree-l1"><a class="reference external" href="https://trustedfirmware-m.readthedocs.io/projects/tf-m-extras/en/latest/">TF-M Extras</a></li>
<li class="toctree-l1"><a class="reference external" href="https://ci.trustedfirmware.org/job/tf-m-build-docs-nightly/lastSuccessfulBuild/artifact/trusted-firmware-m/build/docs/reference_manual/html/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.trustedfirmware.org/w/collaboration/security_center">Security Center</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.arm.com/architecture/security-features/platform-security">PSA</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">STMICROELECTRONICS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../stm/releases/index.html">Releases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stm/releases/getting_started.html">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32h573i_dk/readme.html">STM32H573I_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32l562e_dk/readme.html">STM32L562E_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp215f_dk/readme.html">stm32mp215f_dk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO_L552ZE_Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/b_u585i_iot02a/readme.html">B_U585I_IOT02A</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/releases/platforms.html">Platforms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32h5xx/readme.html">STM32H5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32l5xx/readme.html">STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32mp2xx/readme.html">STM32MP2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32u5xx/readme.html">STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO_L552ZE_Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32h573i_dk/readme.html">STM32H573I_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32l562e_dk/readme.html">STM32L562E_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp215f_dk/readme.html">stm32mp215f_dk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/releases/changelog.html">Change Log &amp; Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/releases/v1.7.0/index.html">v1.7.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/releases/v2.1.0/index.html">v2.1.0</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stm/releases/index.html#branch-plans">Branch plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stm/technical/index.html">Technical references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/a35_td_flavor/index.html">A35-TD flavor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/a35_td_flavor/memory_layout.html">Memory layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/a35_td_flavor/storage.html">Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/m33_td_flavor/index.html">M33-TD flavor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/m33_td_flavor/memory_layout.html">Memory layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/m33_td_flavor/storage.html">Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/devicetree/index.html">Devicetree</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/devicetree/devicetree_tfm.html">Scope and purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/devicetree/devicetree_tfm.html#concept">Concept</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/devicetree/devicetree_tfm.html#how-to-add-device">How to add device</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/initlevel.html">Initlevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/initial_attestation.html">Initial Attestation Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/nv_counter.html">Nv counter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stm/ide/index.html">Ide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stm/ide/cube/stm32cubeide.html">STM32CubeIDE</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Trusted Firmware-M</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="tfm_build_instruction.html">Build instructions</a></li>
      <li class="breadcrumb-item active">Run TF-M tests and applications on Arm platforms</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="run-tf-m-tests-and-applications-on-arm-platforms">
<h1>Run TF-M tests and applications on Arm platforms<a class="headerlink" href="#run-tf-m-tests-and-applications-on-arm-platforms" title="Permalink to this heading"></a></h1>
<p>Instructions for how to run TF-M tests and applications on Arm platforms.</p>
<p>Follow <a class="reference internal" href="tfm_build_instruction.html"><span class="doc">build instruction</span></a> to build the binaries.
Follow <a class="reference internal" href="../design_docs/booting/tfm_secure_boot.html"><span class="doc">secure boot</span></a> to build the
binaries with or without BL2 bootloader.</p>
<div class="section" id="execute-tf-m-regression-tests-on-mps2-boards-and-fvp">
<span id="tf-m-regression-tests"></span><h2>Execute TF-M regression tests on MPS2 boards and FVP<a class="headerlink" href="#execute-tf-m-regression-tests-on-mps2-boards-and-fvp" title="Permalink to this heading"></a></h2>
<p>The BL2 bootloader and TF-M example application and tests have been verified
using the reference model for MPS2 (AN521), in  <a class="reference external" href="http://www2.keil.com/mdk5">Keil MDK</a> ,
<a class="reference external" href="https://developer.arm.com/tools-and-software/simulation-models/fixed-virtual-platforms">Fixed Virtual Platforms</a> and <a class="reference external" href="https://developer.arm.com/tools-and-software/embedded/arm-development-studio">Arm Development Studio</a> .</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The name of the reference model’s executable can vary depending on toolchain.</p>
<ul class="simple">
<li><p>SMM-SSE-200 for <a class="reference external" href="http://www2.keil.com/mdk5">Keil MDK</a></p></li>
<li><p>FVP_MPS2_AEMv8M for <a class="reference external" href="https://developer.arm.com/tools-and-software/simulation-models/fixed-virtual-platforms">Fixed Virtual Platforms</a> and <a class="reference external" href="https://developer.arm.com/tools-and-software/embedded/arm-development-studio">Arm Development Studio</a></p></li>
</ul>
<p>For more information please refer to the appropriate toolchain’s
documentation:  <a class="reference external" href="https://www2.keil.com/mdk5/docs">Keil MDK Documentation</a> ,
<a class="reference external" href="https://developer.arm.com/documentation/100966/latest">Fixed Virtual Platforms Documentation</a> ,
<a class="reference external" href="https://developer.arm.com/tools-and-software/embedded/arm-development-studio/learn/docs">Arm Development Studio Documentation</a></p>
</div>
<div class="section" id="to-run-the-example-code-on-an-sse-200-fast-model">
<h3>To run the example code on an SSE-200 Fast-Model<a class="headerlink" href="#to-run-the-example-code-on-an-sse-200-fast-model" title="Permalink to this heading"></a></h3>
<p>Using FVP_MPS2_AEMv8M provided by <a class="reference external" href="https://developer.arm.com/tools-and-software/embedded/arm-development-studio">Arm Development Studio</a> 2019.1.</p>
<div class="section" id="example-application-and-regression-tests-without-bl2-bootloader">
<h4>Example application and regression tests without BL2 bootloader<a class="headerlink" href="#example-application-and-regression-tests-without-bl2-bootloader" title="Permalink to this heading"></a></h4>
<p>Add <code class="docutils literal notranslate"><span class="pre">tfm_s.axf</span></code> and <code class="docutils literal notranslate"><span class="pre">tfm_ns.axf</span></code> to symbol files in Debug Configuration
menu.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&lt;DS_PATH&gt;/sw/models/bin/FVP_MPS2_AEMv8M<span class="w"> </span><span class="se">\</span>
--parameter<span class="w"> </span>fvp_mps2.platform_type<span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="se">\</span>
--parameter<span class="w"> </span>cpu0.baseline<span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="se">\</span>
--parameter<span class="w"> </span>cpu0.INITVTOR_S<span class="o">=</span>0x10000000<span class="w"> </span><span class="se">\</span>
--parameter<span class="w"> </span>cpu0.semihosting-enable<span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="se">\</span>
--parameter<span class="w"> </span>fvp_mps2.DISABLE_GATING<span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="se">\</span>
--parameter<span class="w"> </span>fvp_mps2.telnetterminal0.start_telnet<span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
--parameter<span class="w"> </span>fvp_mps2.telnetterminal1.start_telnet<span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="se">\</span>
--parameter<span class="w"> </span>fvp_mps2.telnetterminal2.start_telnet<span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="se">\</span>
--parameter<span class="w"> </span>fvp_mps2.telnetterminal0.quiet<span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="se">\</span>
--parameter<span class="w"> </span>fvp_mps2.telnetterminal1.quiet<span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
--parameter<span class="w"> </span>fvp_mps2.telnetterminal2.quiet<span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="se">\</span>
--application<span class="w"> </span><span class="nv">cpu0</span><span class="o">=</span>&lt;build_dir&gt;/bin/tfm_s.axf<span class="w"> </span><span class="se">\</span>
--data<span class="w"> </span><span class="nv">cpu0</span><span class="o">=</span>&lt;build_dir&gt;/bin/tfm_ns.bin@0x00100000
</pre></div>
</div>
</div>
<div class="section" id="example-application-and-regression-tests-with-bl2-bootloader">
<h4>Example application and regression tests with BL2 bootloader<a class="headerlink" href="#example-application-and-regression-tests-with-bl2-bootloader" title="Permalink to this heading"></a></h4>
<p>To test TF-M with bootloader, one must apply the following changes:</p>
<ul class="simple">
<li><p>Add <code class="docutils literal notranslate"><span class="pre">bl2.axf</span></code> to symbol files in DS-5 in Debug Configuration
menu.</p></li>
<li><p>Replace the last two lines of the previous command with this:</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>--application<span class="w"> </span><span class="nv">cpu0</span><span class="o">=</span>&lt;build_dir&gt;/bin/bl2.axf<span class="w"> </span><span class="se">\</span>
--data<span class="w"> </span><span class="nv">cpu0</span><span class="o">=</span>&lt;build_dir&gt;/tfm_s_ns_signed.bin@0x10080000
</pre></div>
</div>
<div class="section" id="test-software-upgrade-with-bl2-bootloader">
<h5>Test software upgrade with BL2 bootloader<a class="headerlink" href="#test-software-upgrade-with-bl2-bootloader" title="Permalink to this heading"></a></h5>
<p>BL2 bootloader is mandatory to test software update. Furthermore, two TF-M blobs
must be built. Outputs of example application and regression test can be used to
test it. Load output of example application to the primary slot (0x10080000) and
output of regression test to the secondary slot (0x10180000). Add the following
line to the end of the previous chapter:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>--data<span class="w"> </span><span class="nv">cpu0</span><span class="o">=</span>&lt;build_dir&gt;/tfm_s_ns_signed.bin@0x10180000
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="to-run-the-example-code-on-sse-200-fpga-on-mps2-board">
<h3>To run the example code on SSE 200 FPGA on MPS2 board<a class="headerlink" href="#to-run-the-example-code-on-sse-200-fpga-on-mps2-board" title="Permalink to this heading"></a></h3>
<p>FPGA image is available to download
<a class="reference external" href="https://developer.arm.com/products/system-design/development-boards/cortex-m-prototyping-systems/mps2">here</a></p>
<p>To run BL2 bootloader and TF-M example application and tests in the MPS2 board,
it is required to have SMM-SSE-200 for MPS2 (AN521) image in the MPS2 board SD
card. The image should be located in
<code class="docutils literal notranslate"><span class="pre">&lt;MPS2</span> <span class="pre">device</span> <span class="pre">name&gt;/MB/HBI0263&lt;board</span> <span class="pre">revision</span> <span class="pre">letter&gt;/AN521</span></code></p>
<p>The MPS2 board tested is HBI0263C referred also as MPS2+.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you change the exe names, MPS2 expects file names in 8.3 format.</p>
</div>
<div class="section" id="example-application">
<h4>Example application<a class="headerlink" href="#example-application" title="Permalink to this heading"></a></h4>
<ol class="arabic">
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">bl2.bin</span></code> and <code class="docutils literal notranslate"><span class="pre">tfm_s_ns_signed.bin</span></code> files from
<code class="docutils literal notranslate"><span class="pre">&lt;build_dir&gt;/bin</span></code> to
<code class="docutils literal notranslate"><span class="pre">&lt;MPS2</span> <span class="pre">device</span> <span class="pre">name&gt;/SOFTWARE/</span></code></p></li>
<li><p>Open <code class="docutils literal notranslate"><span class="pre">&lt;MPS2</span> <span class="pre">device</span> <span class="pre">name&gt;/MB/HBI0263C/AN521/images.txt</span></code></p></li>
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">AN521/images.txt</span></code> file as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TITLE</span><span class="p">:</span> <span class="n">Versatile</span> <span class="n">Express</span> <span class="n">Images</span> <span class="n">Configuration</span> <span class="n">File</span>
<span class="p">[</span><span class="n">IMAGES</span><span class="p">]</span>
<span class="n">TOTALIMAGES</span><span class="p">:</span> <span class="mi">2</span>                     <span class="p">;</span><span class="n">Number</span> <span class="n">of</span> <span class="n">Images</span> <span class="p">(</span><span class="n">Max</span><span class="p">:</span> <span class="mi">32</span><span class="p">)</span>
<span class="n">IMAGE0ADDRESS</span><span class="p">:</span> <span class="mh">0x10000000</span>
<span class="n">IMAGE0FILE</span><span class="p">:</span> \<span class="n">Software</span>\<span class="n">bl2</span><span class="o">.</span><span class="n">bin</span>  <span class="p">;</span> <span class="n">BL2</span> <span class="n">bootloader</span>
<span class="n">IMAGE1ADDRESS</span><span class="p">:</span> <span class="mh">0x10080000</span>
<span class="n">IMAGE1FILE</span><span class="p">:</span> \<span class="n">Software</span>\<span class="n">tfm_s_ns_signed</span><span class="o">.</span><span class="n">bin</span> <span class="p">;</span> <span class="n">TF</span><span class="o">-</span><span class="n">M</span> <span class="n">example</span> <span class="n">application</span> <span class="n">binary</span> <span class="n">blob</span>
</pre></div>
</div>
</li>
<li><p>Close <code class="docutils literal notranslate"><span class="pre">&lt;MPS2</span> <span class="pre">device</span> <span class="pre">name&gt;/MB/HBI0263C/AN521/images.txt</span></code></p></li>
<li><p>Unmount/eject the <code class="docutils literal notranslate"><span class="pre">&lt;MPS2</span> <span class="pre">device</span> <span class="pre">name&gt;</span></code> unit</p></li>
<li><p>Reset the board to execute the TF-M example application</p></li>
<li><p>After completing the procedure you should be able to visualize on the serial
port (baud 115200 8n1) the following messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[INF] Starting bootloader
[INF] Image 0: magic=good, copy_done=0xff, image_ok=0xff
[INF] Scratch: magic=bad, copy_done=0x5, image_ok=0xcf
[INF] Boot source: primary slot
[INF] Swap type: none
[INF] Bootloader chainload address offset: 0x80000
[INF] Jumping to the first image slot
[Sec Thread] Secure image initializing!
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="regression-tests">
<h4>Regression tests<a class="headerlink" href="#regression-tests" title="Permalink to this heading"></a></h4>
<p>After completing the procedure you should be able to visualize on the serial
port (baud 115200 8n1) the following messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[INF] Starting bootloader
[INF] Image 0: magic=good, copy_done=0xff, image_ok=0xff
[INF] Scratch: magic=bad, copy_done=0x5, image_ok=0xcf
[INF] Boot source: primary slot
[INF] Swap type: none
[INF] Bootloader chainload address offset: 0x80000
[INF] Jumping to the first image slot
[Sec Thread] Secure image initializing!

#### Execute test suites for the protected storage service ####
Running Test Suite PS secure interface tests (TFM_PS_TEST_2XXX)...

&gt; Executing &#39;TFM_PS_TEST_2001&#39;
  Description: &#39;Create interface&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2002&#39;
  Description: &#39;Get handle interface (DEPRECATED)&#39;
This test is DEPRECATED and the test execution was SKIPPED
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2003&#39;
  Description: &#39;Get handle with null handle pointer (DEPRECATED)&#39;
This test is DEPRECATED and the test execution was SKIPPED
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2004&#39;
  Description: &#39;Write interface&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2005&#39;
  Description: &#39;Read interface&#39;
....
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PS reliability tests take a few minutes to run on the MPS2.</p>
</div>
</div>
<div class="section" id="example-application-without-bl2-bootloader">
<h4>Example application without BL2 bootloader<a class="headerlink" href="#example-application-without-bl2-bootloader" title="Permalink to this heading"></a></h4>
<ol class="arabic">
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">tfm_s.bin</span></code> and <code class="docutils literal notranslate"><span class="pre">tfm_ns.bin</span></code> files from
<code class="docutils literal notranslate"><span class="pre">&lt;build_dir&gt;/bin</span></code> to
<code class="docutils literal notranslate"><span class="pre">&lt;MPS2</span> <span class="pre">device</span> <span class="pre">name&gt;/SOFTWARE/</span></code></p></li>
<li><p>Open <code class="docutils literal notranslate"><span class="pre">&lt;MPS2</span> <span class="pre">device</span> <span class="pre">name&gt;/MB/HBI0263C/AN521/images.txt</span></code></p></li>
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">AN521/images.txt</span></code> file as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TITLE</span><span class="p">:</span> <span class="n">Versatile</span> <span class="n">Express</span> <span class="n">Images</span> <span class="n">Configuration</span> <span class="n">File</span>
<span class="p">[</span><span class="n">IMAGES</span><span class="p">]</span>
<span class="n">TOTALIMAGES</span><span class="p">:</span> <span class="mi">2</span>                   <span class="p">;</span><span class="n">Number</span> <span class="n">of</span> <span class="n">Images</span> <span class="p">(</span><span class="n">Max</span><span class="p">:</span> <span class="mi">32</span><span class="p">)</span>
<span class="n">IMAGE0ADDRESS</span><span class="p">:</span> <span class="mh">0x10000000</span>
<span class="n">IMAGE0FILE</span><span class="p">:</span> \<span class="n">Software</span>\<span class="n">tfm_s</span><span class="o">.</span><span class="n">bin</span>  <span class="p">;</span> <span class="n">Secure</span> <span class="n">code</span>
<span class="n">IMAGE1ADDRESS</span><span class="p">:</span> <span class="mh">0x00100000</span>
<span class="n">IMAGE1FILE</span><span class="p">:</span> \<span class="n">Software</span>\<span class="n">tfm_ns</span><span class="o">.</span><span class="n">bin</span> <span class="p">;</span> <span class="n">Non</span><span class="o">-</span><span class="n">secure</span> <span class="n">code</span>
</pre></div>
</div>
</li>
<li><p>Close <code class="docutils literal notranslate"><span class="pre">&lt;MPS2</span> <span class="pre">device</span> <span class="pre">name&gt;/MB/HBI0263C/AN521/images.txt</span></code></p></li>
<li><p>Unmount/eject the <code class="docutils literal notranslate"><span class="pre">&lt;MPS2</span> <span class="pre">device</span> <span class="pre">name&gt;</span></code> unit</p></li>
<li><p>Reset the board to execute the TF-M example application</p></li>
<li><p>After completing the procedure you should be able to visualize on the serial
port (baud 115200 8n1) the following messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Sec Thread] Secure image initializing!
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="regression-tests-without-bl2-bootloader">
<h4>Regression tests without BL2 bootloader<a class="headerlink" href="#regression-tests-without-bl2-bootloader" title="Permalink to this heading"></a></h4>
<p>After completing the procedure you should be able to visualize on the serial
port (baud 115200 8n1) the following messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Sec Thread] Secure image initializing!

#### Execute test suites for the protected storage service ####
Running Test Suite PS secure interface tests (TFM_PS_TEST_2XXX)...

&gt; Executing &#39;TFM_PS_TEST_2001&#39;
  Description: &#39;Create interface&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2002&#39;
  Description: &#39;Get handle interface (DEPRECATED)&#39;
This test is DEPRECATED and the test execution was SKIPPED
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2003&#39;
  Description: &#39;Get handle with null handle pointer (DEPRECATED)&#39;
This test is DEPRECATED and the test execution was SKIPPED
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2004&#39;
  Description: &#39;Write interface&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2005&#39;
  Description: &#39;Read interface&#39;
....
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="execute-tf-m-regression-tests-on-musca-test-chip-boards">
<h2>Execute TF-M regression tests on Musca test chip boards<a class="headerlink" href="#execute-tf-m-regression-tests-on-musca-test-chip-boards" title="Permalink to this heading"></a></h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Before executing any images on Musca-B1 board, please check the
<a class="reference internal" href="../platform/arm/musca_b1/readme.html"><span class="doc">target platform readme</span></a>
to have the correct setup.</p>
<p>Install SRecord for Musca test chip boards:</p>
<ul class="simple">
<li><p>Windows: <a class="reference external" href="https://sourceforge.net/projects/srecord/">SRecord v1.63</a></p></li>
<li><p>Linux: <code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">apt-get</span> <span class="pre">install</span> <span class="pre">-y</span> <span class="pre">srecord</span></code></p></li>
</ul>
</div>
<div class="section" id="example-application-with-bl2-bootloader">
<h3>Example application with BL2 bootloader<a class="headerlink" href="#example-application-with-bl2-bootloader" title="Permalink to this heading"></a></h3>
<ol class="arabic">
<li><p>Create a unified hex file comprising of both <code class="docutils literal notranslate"><span class="pre">bl2.bin</span></code> and
<code class="docutils literal notranslate"><span class="pre">tfm_s_ns_signed.bin</span></code> for Musca-B1 or Musca-S1 platforms:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">srec_cat</span> <span class="nb">bin</span><span class="o">/</span><span class="n">bl2</span><span class="o">.</span><span class="n">bin</span> <span class="o">-</span><span class="n">Binary</span> <span class="o">-</span><span class="n">offset</span> <span class="mh">0xA000000</span> <span class="nb">bin</span><span class="o">/</span><span class="n">tfm_s_ns_signed</span><span class="o">.</span><span class="n">bin</span> <span class="o">-</span><span class="n">Binary</span> <span class="o">-</span><span class="n">offset</span> <span class="mh">0xA020000</span> <span class="o">-</span><span class="n">o</span> <span class="n">tfm</span><span class="o">.</span><span class="n">hex</span> <span class="o">-</span><span class="n">Intel</span>
</pre></div>
</div>
</li>
<li><p>Power up the Musca board by connecting it to a computer with a USB lead.
Press the <code class="docutils literal notranslate"><span class="pre">PBON</span></code> button if the green <code class="docutils literal notranslate"><span class="pre">ON</span></code> LED does not immediately turn
on. The board should appear as a USB drive.</p></li>
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">tfm.hex</span></code> to the USB drive. The orange <code class="docutils literal notranslate"><span class="pre">PWR</span></code> LED should start
blinking.</p></li>
<li><p>Once the <code class="docutils literal notranslate"><span class="pre">PWR</span></code> LED stops blinking, power cycle or reset the board to boot
from the new image.</p></li>
<li><p>After completing the procedure you should see the following messages on the
DAPLink UART (baud 115200 8n1):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[INF] Starting bootloader
[INF] Image 0: magic=good, copy_done=0xff, image_ok=0xff
[INF] Scratch: magic=bad, copy_done=0x5, image_ok=0xd9
[INF] Boot source: primary slot
[INF] Swap type: none
[INF] Bootloader chainload address offset: 0x20000
[INF] Jumping to the first image slot
[Sec Thread] Secure image initializing!
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="regression-tests-with-bl2-bootloader">
<h3>Regression tests with BL2 bootloader<a class="headerlink" href="#regression-tests-with-bl2-bootloader" title="Permalink to this heading"></a></h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As the Internal Trusted Storage and Protected Storage tests use persistent
storage, it is recommended to erase the storage area before running the
tests. Existing data may prevent the tests from running to completion if,
for example, there is not enough free space for the test data or the UIDs
used by the tests have already been created with the write-once flag set.
Repeated test runs can be done without erasing between runs.</p>
<p>To erase the storage when flashing an image, <code class="docutils literal notranslate"><span class="pre">-fill</span> <span class="pre">0xFF</span> <span class="pre">&lt;start_addr&gt;</span>
<span class="pre">&lt;end_addr&gt;</span></code> can be added to the <code class="docutils literal notranslate"><span class="pre">srec_cat</span></code> command used to create the
combined hex file. The <code class="docutils literal notranslate"><span class="pre">&lt;start_addr&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;end_addr&gt;</span></code> are the start and
end addresses of the storage area, found in the board’s <code class="docutils literal notranslate"><span class="pre">flash_layout.h</span></code>
file. The board’s flash can also be erased via a debugger; see your IDE’s
documentation for instructions.</p>
</div>
<p>After completing the procedure you should see the following messages on the
DAPLink UART (baud 115200 8n1):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[INF] Starting bootloader
[INF] Image 0: magic=good, copy_done=0xff, image_ok=0xff
[INF] Scratch: magic=bad, copy_done=0x5, image_ok=0x9
[INF] Boot source: primary slot
[INF] Swap type: none
[INF] Bootloader chainload address offset: 0x20000
[INF] Jumping to the first image slot
[Sec Thread] Secure image initializing!

#### Execute test suites for the protected storage service ####
Running Test Suite PS secure interface tests (TFM_PS_TEST_2XXX)...
&gt; Executing &#39;TFM_PS_TEST_2001&#39;
  Description: &#39;Create interface&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2002&#39;
  Description: &#39;Get handle interface (DEPRECATED)&#39;
This test is DEPRECATED and the test execution was SKIPPED
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2003&#39;
  Description: &#39;Get handle with null handle pointer (DEPRECATED)&#39;
This test is DEPRECATED and the test execution was SKIPPED
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2004&#39;
  Description: &#39;Get attributes interface&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2005&#39;
  Description: &#39;Get attributes with null attributes struct pointer&#39;
....
</pre></div>
</div>
</div>
<div class="section" id="psa-api-tests">
<h3>PSA API tests<a class="headerlink" href="#psa-api-tests" title="Permalink to this heading"></a></h3>
<p>Follow the build instructions for the PSA API tests and then follow the above
procedures for flashing the image to the board. The PSA API tests are linked
into the TF-M binaries and will automatically run. A log similar to the
following should be visible on the UART; it is normal for some tests to be
skipped but there should be no failed tests:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Sec Thread] Secure image initializing!
Booting TFM v1.1
Non-Secure system starting...

***** PSA Architecture Test Suite - Version 1.0 *****

Running.. Storage Suite
******************************************

TEST: 401 | DESCRIPTION: UID not found check
[Info] Executing tests from non-secure

[Info] Executing ITS tests
[Check 1] Call get API for UID 6 which is not set
[Check 2] Call get_info API for UID 6 which is not set
[Check 3] Call remove API for UID 6 which is not set
[Check 4] Call get API for UID 6 which is removed
[Check 5] Call get_info API for UID 6 which is removed
[Check 6] Call remove API for UID 6 which is removed
[Check 7] Call get API for different UID 5
[Check 8] Call get_info API for different UID 5
[Check 9] Call remove API for different UID 5

[Info] Executing PS tests
[Check 1] Call get API for UID 6 which is not set
[Check 2] Call get_info API for UID 6 which is not set
[Check 3] Call remove API for UID 6 which is not set
[Check 4] Call get API for UID 6 which is removed
[Check 5] Call get_info API for UID 6 which is removed
[Check 6] Call remove API for UID 6 which is removed
[Check 7] Call get API for different UID 5
[Check 8] Call get_info API for different UID 5
[Check 9] Call remove API for different UID 5

TEST RESULT: PASSED

******************************************

&lt;further tests removed from log for brevity&gt;

************ Storage Suite Report **********
TOTAL TESTS     : 17
TOTAL PASSED    : 11
TOTAL SIM ERROR : 0
TOTAL FAILED    : 0
TOTAL SKIPPED   : 6
******************************************
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The Internal Trusted Storage and Protected Storage flash areas must be wiped
before running the Storage test suites.</p>
<p>Many IDEs for embedded development (such as Keil µVision) offer a function
to erase a device’s flash. Refer to your IDE’s documentation for
instructions.</p>
<p>Another way this can be achieved is by using <code class="docutils literal notranslate"><span class="pre">srec_cat</span></code> with the <code class="docutils literal notranslate"><span class="pre">-fill</span></code>
parameter to fill the corresponding area in the binary with the erase value
of the flash (<code class="docutils literal notranslate"><span class="pre">0xFF</span></code>).</p>
<p>Refer to the platform flash layout for appropriate addresses to erase on
other platforms.</p>
<p>This step is not required on targets that emulate flash storage in RAM, as
it will be erased each time the device is reset. Note, however, that a warm
reset may not clear SRAM contents, so it may be necessary to power the
device off and on again between test runs.</p>
</div>
</div>
<div class="section" id="example-application-or-regression-tests-on-musca-b1-without-bl2-bootloader">
<h3>Example application or regression tests on Musca-B1 without BL2 bootloader<a class="headerlink" href="#example-application-or-regression-tests-on-musca-b1-without-bl2-bootloader" title="Permalink to this heading"></a></h3>
<p>Follow the above procedures, but create a unified hex file out of <code class="docutils literal notranslate"><span class="pre">tfm_s.bin</span></code>
and <code class="docutils literal notranslate"><span class="pre">tfm_ns.bin</span></code>:</p>
<ul>
<li><p>Windows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">srec_cat</span><span class="o">.</span><span class="n">exe</span> <span class="nb">bin</span>\<span class="n">tfm_s</span><span class="o">.</span><span class="n">bin</span> <span class="o">-</span><span class="n">Binary</span> <span class="o">-</span><span class="n">offset</span> <span class="mh">0xA000000</span> <span class="nb">bin</span>\<span class="n">tfm_ns</span><span class="o">.</span><span class="n">bin</span> <span class="o">-</span><span class="n">Binary</span> <span class="o">-</span><span class="n">offset</span> <span class="mh">0xA080000</span> <span class="o">-</span><span class="n">o</span> <span class="n">tfm</span><span class="o">.</span><span class="n">hex</span> <span class="o">-</span><span class="n">Intel</span>
</pre></div>
</div>
</li>
<li><p>Linux:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">srec_cat</span> <span class="nb">bin</span><span class="o">/</span><span class="n">tfm_s</span><span class="o">.</span><span class="n">bin</span> <span class="o">-</span><span class="n">Binary</span> <span class="o">-</span><span class="n">offset</span> <span class="mh">0xA000000</span> <span class="nb">bin</span><span class="o">/</span><span class="n">tfm_ns</span><span class="o">.</span><span class="n">bin</span> <span class="o">-</span><span class="n">Binary</span> <span class="o">-</span><span class="n">offset</span> <span class="mh">0xA080000</span> <span class="o">-</span><span class="n">o</span> <span class="n">tfm</span><span class="o">.</span><span class="n">hex</span> <span class="o">-</span><span class="n">Intel</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
<div class="section" id="execute-tf-m-example-and-regression-tests-on-mps3-boards">
<h2>Execute TF-M example and regression tests on MPS3 boards<a class="headerlink" href="#execute-tf-m-example-and-regression-tests-on-mps3-boards" title="Permalink to this heading"></a></h2>
<div class="section" id="to-run-the-example-code-on-corelink-sse-200-subsystem-for-mps3-an524">
<h3>To run the example code on CoreLink SSE-200 Subsystem for MPS3 (AN524)<a class="headerlink" href="#to-run-the-example-code-on-corelink-sse-200-subsystem-for-mps3-an524" title="Permalink to this heading"></a></h3>
<p>FPGA image is available to download <a class="reference external" href="https://www.arm.com/products/development-tools/development-boards/mps3">here</a></p>
<p>To run BL2 bootloader and TF-M example application and tests in the MPS3 board,
it is required to have SMM-SSE-200 for MPS3 (AN524) image in the MPS3 board
SD card. The image should be located in
<code class="docutils literal notranslate"><span class="pre">&lt;MPS3</span> <span class="pre">device</span> <span class="pre">name&gt;/MB/HBI&lt;BoardNumberBoardrevision&gt;/AN524</span></code></p>
<p>And the current boot memory for AN524 is QSPI flash, so you need to set the
correct REMAP option in
<code class="docutils literal notranslate"><span class="pre">&lt;MPS3</span> <span class="pre">device</span> <span class="pre">name&gt;/MB/HBI&lt;BoardNumberBoardrevision&gt;/AN524/an524_v1.txt</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">REMAP</span><span class="p">:</span> <span class="n">QSPI</span>                 <span class="p">;</span><span class="n">REMAP</span> <span class="n">boot</span> <span class="n">device</span> <span class="n">BRAM</span><span class="o">/</span><span class="n">QSPI</span><span class="o">.</span>  <span class="n">Must</span> <span class="n">match</span> <span class="n">REMAPVAL</span> <span class="n">below</span><span class="o">.</span>
<span class="n">REMAPVAL</span><span class="p">:</span> <span class="mi">1</span>                 <span class="p">;</span><span class="n">REMAP</span> <span class="n">register</span> <span class="n">value</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="mi">0</span><span class="o">-</span><span class="n">BRAM</span><span class="o">.</span> <span class="mi">1</span><span class="o">-</span><span class="n">QSPI</span>
</pre></div>
</div>
<p>The MPS3 board tested is HBI0309B.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you change the exe names, MPS3 expects file names in 8.3 format.</p>
</div>
<div class="section" id="id1">
<h4>Example application<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h4>
<ol class="arabic">
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">bl2.bin</span></code> and <code class="docutils literal notranslate"><span class="pre">tfm_s_ns_signed.bin</span></code> files from
build dir to <code class="docutils literal notranslate"><span class="pre">&lt;MPS3</span> <span class="pre">device</span> <span class="pre">name&gt;/SOFTWARE/</span></code></p></li>
<li><p>Open <code class="docutils literal notranslate"><span class="pre">&lt;MPS3</span> <span class="pre">device</span> <span class="pre">name&gt;/MB/HBI0309B/AN524/images.txt</span></code></p></li>
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">images.txt</span></code> file as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TITLE</span><span class="p">:</span> <span class="n">Arm</span> <span class="n">MPS3</span> <span class="n">FPGA</span> <span class="n">prototyping</span> <span class="n">board</span> <span class="n">Images</span> <span class="n">Configuration</span> <span class="n">File</span>

<span class="p">[</span><span class="n">IMAGES</span><span class="p">]</span>
<span class="n">TOTALIMAGES</span><span class="p">:</span> <span class="mi">2</span>                     <span class="p">;</span><span class="n">Number</span> <span class="n">of</span> <span class="n">Images</span> <span class="p">(</span><span class="n">Max</span><span class="p">:</span> <span class="mi">32</span><span class="p">)</span>

<span class="n">IMAGE0UPDATE</span><span class="p">:</span> <span class="n">AUTO</span>                 <span class="p">;</span><span class="n">Image</span> <span class="n">Update</span><span class="p">:</span><span class="n">NONE</span><span class="o">/</span><span class="n">AUTO</span><span class="o">/</span><span class="n">FORCE</span>
<span class="n">IMAGE0ADDRESS</span><span class="p">:</span> <span class="mh">0x00000000</span>          <span class="p">;</span><span class="n">Please</span> <span class="n">select</span> <span class="n">the</span> <span class="n">required</span> <span class="n">executable</span> <span class="n">program</span>
<span class="n">IMAGE0FILE</span><span class="p">:</span> \<span class="n">SOFTWARE</span>\<span class="n">bl2</span><span class="o">.</span><span class="n">bin</span>
<span class="n">IMAGE1UPDATE</span><span class="p">:</span> <span class="n">AUTO</span>
<span class="n">IMAGE1ADDRESS</span><span class="p">:</span> <span class="mh">0x00040000</span>
<span class="n">IMAGE1FILE</span><span class="p">:</span> \<span class="n">SOFTWARE</span>\<span class="n">tfm_s_ns_signed</span><span class="o">.</span><span class="n">bin</span>
</pre></div>
</div>
</li>
<li><p>Close <code class="docutils literal notranslate"><span class="pre">&lt;MPS3</span> <span class="pre">device</span> <span class="pre">name&gt;/MB/HBI0309B/AN524/images.txt</span></code></p></li>
<li><p>Unmount/eject the <code class="docutils literal notranslate"><span class="pre">&lt;MPS3</span> <span class="pre">device</span> <span class="pre">name&gt;</span></code> unit</p></li>
<li><p>Reset the board to execute the TF-M example application</p></li>
<li><p>After completing the procedure you should be able to visualize on the serial
port (baud 115200 8n1) the following messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[INF] Starting bootloader
[INF] Image 0: magic= good, copy_done=0xff, image_ok=0xff
[INF] Scratch: magic=unset, copy_done=0x43, image_ok=0xff
[INF] Boot source: slot 0
[INF] Swap type: none
[INF] Bootloader chainload address offset: 0x40000
[INF] Jumping to the first image slot
[Sec Thread] Secure image initializing!
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <code class="docutils literal notranslate"><span class="pre">-DPLATFORM_DEFAULT_PROVISIONING=OFF</span></code> is set then the provisioning bundle has to
be placed on the <code class="docutils literal notranslate"><span class="pre">0x001CB000</span></code> address.</p>
</div>
</div>
<div class="section" id="id2">
<h4>Regression tests<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h4>
<p>After completing the procedure you should be able to visualize on the serial
port (baud 115200 8n1) the following messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[INF] Starting bootloader
[INF] Image 0: magic= good, copy_done=0xff, image_ok=0xff
[INF] Scratch: magic=unset, copy_done=0x9, image_ok=0xff
[INF] Boot source: slot 0
[INF] Swap type: none
[INF] Bootloader chainload address offset: 0x40000
[INF] Jumping to the first image slot
[Sec Thread] Secure image initializing!

#### Execute test suites for the Secure area ####
Running Test Suite PSA protected storage S interface tests (TFM_PS_TEST_2XXX)...
&gt; Executing &#39;TFM_PS_TEST_2001&#39;
  Description: &#39;Set interface&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2002&#39;
  Description: &#39;Set interface with create flags&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2003&#39;
  Description: &#39;Set interface with NULL data pointer&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2004&#39;
  Description: &#39;Set interface with invalid data length&#39;
  TEST PASSED!
....
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some of the attestation tests take a few minutes to run on the MPS3.</p>
</div>
</div>
<div class="section" id="id3">
<h4>Example application without BL2 bootloader<a class="headerlink" href="#id3" title="Permalink to this heading"></a></h4>
<ol class="arabic">
<li><p>Copy <code class="docutils literal notranslate"><span class="pre">tfm_s.bin</span></code> and <code class="docutils literal notranslate"><span class="pre">tfm_ns.bin</span></code> files from
build dir to <code class="docutils literal notranslate"><span class="pre">&lt;MPS3</span> <span class="pre">device</span> <span class="pre">name&gt;/SOFTWARE/</span></code></p></li>
<li><p>Open <code class="docutils literal notranslate"><span class="pre">&lt;MPS3</span> <span class="pre">device</span> <span class="pre">name&gt;/MB/HBI0309B/AN524/images.txt</span></code></p></li>
<li><p>Update the <code class="docutils literal notranslate"><span class="pre">images.txt</span></code> file as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TITLE</span><span class="p">:</span> <span class="n">Arm</span> <span class="n">MPS3</span> <span class="n">FPGA</span> <span class="n">prototyping</span> <span class="n">board</span> <span class="n">Images</span> <span class="n">Configuration</span> <span class="n">File</span>

<span class="p">[</span><span class="n">IMAGES</span><span class="p">]</span>
<span class="n">TOTALIMAGES</span><span class="p">:</span> <span class="mi">2</span>                     <span class="p">;</span><span class="n">Number</span> <span class="n">of</span> <span class="n">Images</span> <span class="p">(</span><span class="n">Max</span><span class="p">:</span> <span class="mi">32</span><span class="p">)</span>

<span class="n">IMAGE0UPDATE</span><span class="p">:</span> <span class="n">AUTO</span>                 <span class="p">;</span><span class="n">Image</span> <span class="n">Update</span><span class="p">:</span><span class="n">NONE</span><span class="o">/</span><span class="n">AUTO</span><span class="o">/</span><span class="n">FORCE</span>
<span class="n">IMAGE0ADDRESS</span><span class="p">:</span> <span class="mh">0x00000000</span>          <span class="p">;</span><span class="n">Please</span> <span class="n">select</span> <span class="n">the</span> <span class="n">required</span> <span class="n">executable</span> <span class="n">program</span>
<span class="n">IMAGE0FILE</span><span class="p">:</span> \<span class="n">SOFTWARE</span>\<span class="n">tfm_s</span><span class="o">.</span><span class="n">bin</span>
<span class="n">IMAGE1UPDATE</span><span class="p">:</span> <span class="n">AUTO</span>
<span class="n">IMAGE1ADDRESS</span><span class="p">:</span> <span class="mh">0x000C0000</span>
<span class="n">IMAGE1FILE</span><span class="p">:</span> \<span class="n">SOFTWARE</span>\<span class="n">tfm_ns</span><span class="o">.</span><span class="n">bin</span>
</pre></div>
</div>
</li>
<li><p>Close <code class="docutils literal notranslate"><span class="pre">&lt;MPS3</span> <span class="pre">device</span> <span class="pre">name&gt;/MB/HBI0309B/AN521/images.txt</span></code></p></li>
<li><p>Unmount/eject the <code class="docutils literal notranslate"><span class="pre">&lt;MPS3</span> <span class="pre">device</span> <span class="pre">name&gt;</span></code> unit</p></li>
<li><p>Reset the board to execute the TF-M example application</p></li>
<li><p>After completing the procedure you should be able to visualize on the serial
port (baud 115200 8n1) the following messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Sec Thread] Secure image initializing!
</pre></div>
</div>
</li>
</ol>
</div>
<div class="section" id="id4">
<h4>Regression tests without BL2 bootloader<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h4>
<p>After completing the procedure you should be able to visualize on the serial
port (baud 115200 8n1) the following messages:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>[Sec Thread] Secure image initializing!

#### Execute test suites for the Secure area ####
Running Test Suite PSA protected storage S interface tests (TFM_PS_TEST_2XXX)...
&gt; Executing &#39;TFM_PS_TEST_2001&#39;
  Description: &#39;Set interface&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2002&#39;
  Description: &#39;Set interface with create flags&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2003&#39;
  Description: &#39;Set interface with NULL data pointer&#39;
  TEST PASSED!
&gt; Executing &#39;TFM_PS_TEST_2004&#39;
  Description: &#39;Set interface with invalid data length&#39;
  TEST PASSED!
....
</pre></div>
</div>
</div>
</div>
<div class="section" id="firmware-upgrade-and-image-validation-with-bl2-bootloader">
<h3>Firmware upgrade and image validation with BL2 bootloader<a class="headerlink" href="#firmware-upgrade-and-image-validation-with-bl2-bootloader" title="Permalink to this heading"></a></h3>
<p>High level operation of BL2 bootloader and instructions for testing firmware
upgrade is described in <a class="reference internal" href="../design_docs/booting/tfm_secure_boot.html"><span class="doc">secure boot</span></a>.</p>
<hr class="docutils" />
<p><em>Copyright (c) 2017-2024, Arm Limited. All rights reserved.</em></p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>