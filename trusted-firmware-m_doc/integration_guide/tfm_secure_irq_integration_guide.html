<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Secure Interrupt Integration Guide &mdash; Trusted Firmware-M v2.1.0-stm32mp-r1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tfm_custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Platform Provisioning" href="platform_provisioning.html" />
    <link rel="prev" title="Floating-Point Support" href="tfm_fpu_support.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Trusted Firmware-M
              <img src="../_static/tf_logo_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v2.1.0-stm32mp-r1

              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../security/threat_models/generic_threat_model.html">Threat model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/security_advisories/index.html">Security Advisories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/stack_seal_vulnerability.html">Advisory TFMV-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/svc_caller_sp_fetching_vulnerability.html">Advisory TFMV-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/crypto_multi_part_ops_abort_fail.html">Advisory TFMV-3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/profile_small_key_id_encoding_vulnerability.html">Advisory TFMV-4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/fwu_write_vulnerability.html">Advisory TFMV-5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/cc3xx_partial_tag_compare_on_chacha20_poly1305.html">Advisory TFMV-6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/debug_log_vulnerability.html">Advisory TFMV-7</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Releases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../releases/2.1.0.html">v2.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/2.0.0.html">v2.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/1.8.1.html">v1.8.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/1.8.0.html">v1.8.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/release_process.html">Release Cadence and Process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../platform/index.html">Platforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../platform/arm/index.html">Arm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/corstone1000/readme.html">Corstone-1000</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/mps3/corstone300/README.html">Corstone-300 FPGA (AN547 and AN552) and FVP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/mps3/corstone310/README.html">Corstone-310 FPGA (AN555) and FVP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/mps4/corstone315/README.html">Corstone-315 FVP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/musca_b1/readme.html">Musca-B1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/musca_s1/readme.html">Musca-S1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/rse/index.html">Runtime Security Engine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/armchina/index.html">ArmChina</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/armchina/mps3/alcor/README.html">Alcor FPGA (AN557)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/cypress/index.html">Cypress</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/cypress/psoc64/index.html">PSoC64</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/lairdconnectivity/index.html">Laird Connectivity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/lairdconnectivity/bl5340_dvk_cpuapp/README.html">BL5340</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/nordic_nrf/index.html">Nordic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/nordic_nrf/nrf5340dk_nrf5340_cpuapp/README.html">nRF5340</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/nordic_nrf/nrf9160dk_nrf9160/README.html">nRF9160</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/nordic_nrf/nrf9161dk_nrf9161/README.html">nRF9161</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/nuvoton/index.html">Nuvoton</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/nuvoton/m2351/README.html">NuMaker-PFM-M2351</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/nuvoton/m2354/README.html">NuMaker-PFM-M2354</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/nxp/index.html">NXP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/nxp/lpcxpresso55s69/README.html">LPCXpresso55S69</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/stm/index.html">STMICROELECTRONICS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32h5xx/readme.html">STM32H5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32l5xx/readme.html">STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32mp2xx/readme.html">STM32MP2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32u5xx/readme.html">STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO_L552ZE_Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32h573i_dk/readme.html">STM32H573I_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32l562e_dk/readme.html">STM32L562E_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp215f_dk/readme.html">stm32mp215f_dk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/b_u585i_iot02a/readme.html">B_U585I_IOT02A</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../building/tfm_build_instruction.html">Build instructions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../building/tests_build_instruction.html">Build Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../building/run_tfm_examples_on_arm_platforms.html">Run TF-M tests and applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../building/documentation_generation.html">Building the documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../building/tfm_build_instruction_iar.html">IAR toolchain</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration/build_configuration.html">Build configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/header_file_system.html">Component configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/kconfig_system.html">Kconfig</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/profiles/index.html">Profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_small.html"> Small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_medium_arot-less.html"> ARoT-less</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_medium.html"> Medium</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_large.html"> Large</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/test_configuration.html">Tests configuration</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Integration Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="source_structure/source_structure.html">Source Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="source_structure/platform_folder.html">Details for the /platform folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="source_structure/platform_ext_folder.html">Details for the /platform/ext folder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spm_backends.html">SPM Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="non-secure_client_extension_integration_guide.html">NS client integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="os_migration_guide_armv8m.html">OS migration to Armv8-M</a></li>
<li class="toctree-l2"><a class="reference internal" href="tfm_fpu_support.html">Floating-Point Support</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Secure Interrupt</a></li>
<li class="toctree-l2"><a class="reference internal" href="platform_provisioning.html">Platform Provisioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="platform/index.html">Adding a new platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="platform/porting_tfm_to_a_new_hardware.html">Porting TF-M to a New Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="platform/documenting_platform.html">Platform Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="platform/platform_deprecation.html">Platform deprecation and removal</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="services/index.html">Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_attestation_integration_guide.html">Initial Attestation</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_crypto_integration_guide.html">Crypto</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_its_integration_guide.html">Internal Trusted Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_platform_integration_guide.html">Platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_ps_integration_guide.html">Protected Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_secure_partition_addition.html">Adding a New Secure Partition</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_manifest_tool_user_guide.html">Manifest Tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_adac_integration_guide.html">ADAC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../design_docs/index.html">Design Documents</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/booting/tfm_secure_boot.html">Secure Boot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/booting/bl1.html">BL1 Immutable bootloader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/booting/secure_boot_rollback_protection.html">Rollback Protection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/booting/secure_boot_hw_key_integration.html">HW Key integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/dual-cpu/index.html">Dual CPU</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/dual-cpu/booting_a_dual_core_system.html">Booting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/dual-cpu/communication_prototype_between_nspe_and_spe_in_dual_core_systems.html">SPE - NSPE communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/dual-cpu/mailbox_design_on_dual_core_system.html">Mailbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/dual-cpu/mailbox_ns_agent_update.html">Mailbox update</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/dual-cpu/tfm_multi_core_access_check.html">Memory Access Check</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/services/index.html">Secure Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/secure_partition_manager.html">Secure Partition Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/secure_partition_runtime_library.html">Secure Partition RTL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/tfm_psa_inter_process_communication.html">Inter-Process Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/stateless_rot_service.html">Stateless Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/tfm_uniform_secure_service_signature.html">Service Signing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/tfm_crypto_design.html">Crypto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/symmetric_initial_attest.html">Initial Attestation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/tfm_its_service.html">Internal Trusted Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/tfm_fwu_service.html">Firmware Update</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/services/ps_key_management.html">PS Key Management</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/software/index.html">Software Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/software/code_sharing.html">Code Sharing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/software/hardware_abstraction_layer.html">Hardware Abstraction Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/software/tfm_cooperative_scheduling_rules.html">Cooperative Scheduling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/software/tfm_code_generation_with_jinja2.html">Code Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../design_docs/software/enum_implicit_casting.html">Implicit Typecasting</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/ff_isolation.html">Isolation Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/tfm_builtin_keys.html">Builtin Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/tfm_log_system_design_document.html">Logging system</a></li>
<li class="toctree-l2"><a class="reference internal" href="../design_docs/tfm_physical_attack_mitigation.html">Physical Attack Mitigation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Guidelines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/contributing_process.html">The process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/code_review_guide.html">Code review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/maintainers.html">Maintainers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/maintainers.html#code-owners">Code owners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/coding_guide.html">Yet another coding standard :)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/doc_guidelines.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/tfm_design_proposal_guideline.html">Design proposal</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/lic.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/dco.html">DCO</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://trustedfirmware-m.readthedocs.io/projects/tf-m-tests/en/latest/">TF-M Tests</a></li>
<li class="toctree-l1"><a class="reference external" href="https://trustedfirmware-m.readthedocs.io/projects/tf-m-tools/en/latest/">TF-M Tools</a></li>
<li class="toctree-l1"><a class="reference external" href="https://trustedfirmware-m.readthedocs.io/projects/tf-m-extras/en/latest/">TF-M Extras</a></li>
<li class="toctree-l1"><a class="reference external" href="https://ci.trustedfirmware.org/job/tf-m-build-docs-nightly/lastSuccessfulBuild/artifact/trusted-firmware-m/build/docs/reference_manual/html/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.trustedfirmware.org/w/collaboration/security_center">Security Center</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.arm.com/architecture/security-features/platform-security">PSA</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">STMICROELECTRONICS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../stm/releases/index.html">Releases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stm/releases/getting_started.html">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32h573i_dk/readme.html">STM32H573I_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32l562e_dk/readme.html">STM32L562E_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp215f_dk/readme.html">stm32mp215f_dk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO_L552ZE_Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/b_u585i_iot02a/readme.html">B_U585I_IOT02A</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/releases/platforms.html">Platforms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32h5xx/readme.html">STM32H5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32l5xx/readme.html">STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32mp2xx/readme.html">STM32MP2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32u5xx/readme.html">STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO_L552ZE_Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32h573i_dk/readme.html">STM32H573I_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32l562e_dk/readme.html">STM32L562E_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp215f_dk/readme.html">stm32mp215f_dk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/releases/changelog.html">Change Log &amp; Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/releases/v1.7.0/index.html">v1.7.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/releases/v2.1.0/index.html">v2.1.0</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stm/releases/index.html#branch-plans">Branch plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stm/technical/index.html">Technical references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/a35_td_flavor/index.html">A35-TD flavor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/a35_td_flavor/memory_layout.html">Memory layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/a35_td_flavor/storage.html">Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/m33_td_flavor/index.html">M33-TD flavor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/m33_td_flavor/memory_layout.html">Memory layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/m33_td_flavor/storage.html">Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/devicetree/index.html">Devicetree</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/devicetree/devicetree_tfm.html">Scope and purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/devicetree/devicetree_tfm.html#concept">Concept</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/devicetree/devicetree_tfm.html#how-to-add-device">How to add device</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/initlevel.html">Initlevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/initial_attestation.html">Initial Attestation Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/nv_counter.html">Nv counter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stm/ide/index.html">Ide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stm/ide/cube/stm32cubeide.html">STM32CubeIDE</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Trusted Firmware-M</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Integration Guide</a></li>
      <li class="breadcrumb-item active">Secure Interrupt Integration Guide</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="secure-interrupt-integration-guide">
<h1>Secure Interrupt Integration Guide<a class="headerlink" href="#secure-interrupt-integration-guide" title="Permalink to this heading"></a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>This document describes how to enable an interrupt in TF-M. The target audiences
are mainly platform integrators and Secure Partition developers.</p>
<p>This document assumes that you have read the PSA Firmware Framework (FF-M) v1.0
<a class="footnote-reference brackets" href="#id7" id="id1">1</a> and the FF-M v1.1 extensions <a class="footnote-reference brackets" href="#id8" id="id2">2</a> thus have knowlege on the terminologies
such as Secure Partitions and manifests.</p>
</div>
<div class="section" id="interrupt-handling-model">
<h2>Interrupt Handling Model<a class="headerlink" href="#interrupt-handling-model" title="Permalink to this heading"></a></h2>
<p>TF-M supports the two interrupt handling models defined by FF-M:</p>
<ul>
<li><p>First-Level Interrupt Handling (FLIH)</p>
<p>In this model, the interrupt handling is carried out immediately when the
interrupt exception happens.</p>
<p>The interrupt handling can optionally set an interrupt signal for the Secure
Partition Thread to have further data processing.</p>
</li>
<li><p>Second-Level Interrupt Handling (SLIH)</p>
<p>In this model, the interrupt handling is deferred after the interrupt
exception. The handling occurs in the Secure Partition Thread thus is subject
to scheduling.</p>
</li>
</ul>
<p>The FLIH supports handling an interrupt in a bounded time, but very limited APIs
are allowed in the FLIH handling because the handling occurs in an special
exception context.</p>
<p>The SLIH is deferred and subject to scheduling but all Secure Partition APIs are
allowed as the SLIH handling is in the Secure Partition Thread.</p>
<p>Both the FLIH and the SLIH can be used by Secure Partitions which conform to
Firmware Framework v1.1.</p>
<p>While the SLIH is the only supported model for Secure Partitions which conform
to Firmware Framework v1.0.</p>
<p>Please refer to chapter 6.2 of FF-M v1.1 <a class="footnote-reference brackets" href="#id7" id="id3">1</a> for more details on the interrupt
handling models.</p>
</div>
<div class="section" id="enabling-an-interrupt">
<h2>Enabling an Interrupt<a class="headerlink" href="#enabling-an-interrupt" title="Permalink to this heading"></a></h2>
<p>To enable an interrupt, you need to do the following:</p>
<ul class="simple">
<li><p>Binding the interrupt to a Secure Partition.</p></li>
<li><p>Granting the Secure Partition access permissions to the device of the
interrupt.</p></li>
<li><p>Initializing the interrupt.</p></li>
<li><p>Integrating the interrupt handling function</p></li>
</ul>
<p>TF-M has two Test Partitions as good examples for both FLIH <a class="footnote-reference brackets" href="#id9" id="id4">3</a> and SLIH <a class="footnote-reference brackets" href="#id10" id="id5">4</a>.
See also <a class="reference internal" href="#enabling-the-interrupt-tests">Enabling the Interrupt Tests</a> on how to integrate them to platforms.</p>
<div class="section" id="binding-an-interrupt-to-a-secure-partition">
<h3>Binding an Interrupt to a Secure Partition<a class="headerlink" href="#binding-an-interrupt-to-a-secure-partition" title="Permalink to this heading"></a></h3>
<p>To bind an interrupt to a Secure Partition, you need to add an item to the
<code class="docutils literal notranslate"><span class="pre">irqs</span></code> attribute of the Secure Partition manifest.
<code class="docutils literal notranslate"><span class="pre">irqs</span></code> is a list of Interrupt Request (IRQ) assigned to the Secure Partition.</p>
<p>Secure Partitions are not allowed to share IRQs with other Secure Partitions.</p>
<p>Different Firmware Framework versions have different definitions of manifest.</p>
<div class="section" id="ff-m-v1-0">
<h4>FF-M v1.0<a class="headerlink" href="#ff-m-v1-0" title="Permalink to this heading"></a></h4>
<p>Here is an example manifest of Secure Partitions conform to Firmware Framework
version 1.0:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;irqs&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="p p-Indicator">{</span>
<span class="w">      </span><span class="s">&quot;source&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span>
<span class="w">      </span><span class="s">&quot;signal&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;DUAL_TIMER_SIGNAL&quot;</span>
<span class="w">    </span><span class="p p-Indicator">},</span>
<span class="w">    </span><span class="p p-Indicator">{</span>
<span class="w">      </span><span class="s">&quot;source&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;TIMER_1_SOURCE&quot;</span><span class="p p-Indicator">,</span>
<span class="w">      </span><span class="s">&quot;signal&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;TIMER_1_SIGNAL&quot;</span>
<span class="w">    </span><span class="p p-Indicator">}</span>
<span class="w">  </span><span class="p p-Indicator">]</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<ul>
<li><p>source</p>
<p>Required, Unique.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">source</span></code> is a string that identifies the interrupt source.
It can be a valid exception number or a symbolic name defined in platform codes.</p>
</li>
<li><p>signal</p>
<p>Required, Unique.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">signal</span></code> attribute is a symbolic name used by TF-M to identify which
interrupt is asserted.
It is also used by the Secure Partition to receive the interrupt signal by
calling <code class="docutils literal notranslate"><span class="pre">psa_wait</span></code> for interrupt handling.</p>
<p>It is defined in the Secure Partition header file
<code class="docutils literal notranslate"><span class="pre">&lt;psa_manifest/manifestfilename.h&gt;</span></code> generated by TF-M:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#define signal VALUE</span>
</pre></div>
</div>
</li>
</ul>
<p>The interrupt handling model is SLIH by default as it is the only supported one
for FF-M v1.0.</p>
</div>
<div class="section" id="ff-m-v1-1">
<h4>FF-M v1.1<a class="headerlink" href="#ff-m-v1-1" title="Permalink to this heading"></a></h4>
<p>Here is an example manifest of Secure Partitions conform to Firmware Framework
version 1.1:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;irqs&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="p p-Indicator">{</span>
<span class="w">      </span><span class="s">&quot;source&quot;</span><span class="nt">  </span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TIMER_1_SOURCE&quot;</span><span class="p p-Indicator">,</span>
<span class="w">      </span><span class="s">&quot;name&quot;</span><span class="nt">    </span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TIMER_1&quot;</span><span class="p p-Indicator">,</span>
<span class="w">      </span><span class="s">&quot;handling&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;FLIH&quot;</span>
<span class="w">    </span><span class="p p-Indicator">},</span>
<span class="w">    </span><span class="p p-Indicator">{</span>
<span class="w">      </span><span class="s">&quot;source&quot;</span><span class="nt">  </span><span class="p">:</span><span class="w"> </span><span class="nv">5</span><span class="p p-Indicator">,</span>
<span class="w">      </span><span class="s">&quot;name&quot;</span><span class="nt">    </span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DUAL_TIMER&quot;</span><span class="p p-Indicator">,</span>
<span class="w">      </span><span class="s">&quot;handling&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;SLIH&quot;</span>
<span class="w">    </span><span class="p p-Indicator">}</span>
<span class="w">  </span><span class="p p-Indicator">]</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<ul>
<li><p>source</p>
<p>The <code class="docutils literal notranslate"><span class="pre">source</span></code> is the same as the one in Firmware Framework Version 1.0.</p>
</li>
<li><p>name</p>
<p>Required, Unique.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> is used to construct the following two elements:</p>
<ul>
<li><p>the interrupt signal symbol: <code class="docutils literal notranslate"><span class="pre">{{name}}_SIGNAL</span></code>, the equivalent of
<code class="docutils literal notranslate"><span class="pre">signal</span></code> in FF-M v1.0</p></li>
<li><p>the FLIH Function for handling <code class="docutils literal notranslate"><span class="pre">FLIH</span></code> IRQs provided by Secure Partition:</p>
<p><code class="docutils literal notranslate"><span class="pre">psa_flih_result_t</span> <span class="pre">{{name}}_flih(void);</span></code></p>
<p>It is also declared in <code class="docutils literal notranslate"><span class="pre">&lt;psa_manifest/manifestfilename.h&gt;</span></code>.</p>
</li>
</ul>
</li>
<li><p>handling</p>
<p>Required.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">handling</span></code> attribute specifies the interrupt handling model and must
have one of the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FLIH</span></code> - First-Level Interrupt Handling</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SLIH</span></code> - Second-Level Interrupt Handling</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="granting-permissions-to-devices-for-secure-partitions">
<h3>Granting Permissions to Devices for Secure Partitions<a class="headerlink" href="#granting-permissions-to-devices-for-secure-partitions" title="Permalink to this heading"></a></h3>
<p>A secure partition shall be granted two parts of permissions to access a device.
One is the Memory Maped I/O (MMIO) region of the device. The other is the driver
codes to access the device.</p>
<div class="section" id="the-mmio-regions">
<h4>The MMIO Regions<a class="headerlink" href="#the-mmio-regions" title="Permalink to this heading"></a></h4>
<p>You need to declare the MMIO region in the <code class="docutils literal notranslate"><span class="pre">mmio_regions</span></code> attributes in the
Secure Partition manifest, to enable the Secure Partition to access it.</p>
<p>An MMIO region can be described as either <code class="docutils literal notranslate"><span class="pre">numbered_region</span></code> or
<code class="docutils literal notranslate"><span class="pre">named_region</span></code>.
A numbered region consists of a <code class="docutils literal notranslate"><span class="pre">base</span></code> address and a <code class="docutils literal notranslate"><span class="pre">size</span></code>.
A named region consists of a string <code class="docutils literal notranslate"><span class="pre">name</span></code> to describe the region.</p>
<p>Here is an example of named region:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="p p-Indicator">{</span>
<span class="w">  </span><span class="s">&quot;mmio_regions&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="p p-Indicator">[</span>
<span class="w">    </span><span class="p p-Indicator">{</span>
<span class="w">      </span><span class="s">&quot;name&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;TFM_PERIPHERAL_TIMER0&quot;</span><span class="p p-Indicator">,</span>
<span class="w">      </span><span class="s">&quot;permission&quot;</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;READ-WRITE&quot;</span>
<span class="w">    </span><span class="p p-Indicator">}</span>
<span class="w">  </span><span class="p p-Indicator">]</span>
<span class="p p-Indicator">}</span>
</pre></div>
</div>
<ul>
<li><p>name</p>
<p>Required.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">name</span></code> attribute is a symbolic name defined by platforms.
It is a pointer to structure instance that usually includes the base address
and size of the region and some other platform specific attributes that are
required to set up permissions to the MMIO region.</p>
<p>The structure is defined by platforms and the name must be
<code class="docutils literal notranslate"><span class="pre">struct</span> <span class="pre">platform_data_t</span></code>.</p>
</li>
<li><p>permission</p>
<p>Required.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">permission</span></code> attribute must have one of the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">READ-ONLY</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">READ-WRITE</span></code></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="the-device-drivers">
<h4>The Device Drivers<a class="headerlink" href="#the-device-drivers" title="Permalink to this heading"></a></h4>
<p>To give permissions of devices drivers to Secure Partitions, it is recommended
to put the driver codes to the Partition’s CMake library:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>target_sources<span class="o">(</span>some_partition_lib
<span class="w">    </span>PRIVATE
<span class="w">        </span>some_driver_code.c
<span class="o">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="initializing-the-interrupts">
<h3>Initializing the Interrupts<a class="headerlink" href="#initializing-the-interrupts" title="Permalink to this heading"></a></h3>
<p>Platforms must define an interrupt initialization function for each Secure
interrupt.</p>
<p>The prototype of the function is:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">enum</span><span class="w"> </span><span class="n">tfm_hal_status_t</span><span class="w"> </span><span class="p">{</span><span class="n">source_symbol</span><span class="p">}</span><span class="n">_init</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">p_pt</span><span class="p">,</span>
<span class="w">                                           </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">irq_load_info_t</span><span class="w"> </span><span class="o">*</span><span class="n">p_ildi</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">{source_symbol}</span></code> is:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">irq_{source}</span></code>, if the <code class="docutils literal notranslate"><span class="pre">source</span></code> attribute of the IRQ in Partition manifest
is a number</p></li>
<li><p>Lowercase of <code class="docutils literal notranslate"><span class="pre">source</span></code> attribute, if <code class="docutils literal notranslate"><span class="pre">source</span></code> is a symbolic name</p></li>
</ul>
<p>For example if the manifest declares <code class="docutils literal notranslate"><span class="pre">&quot;source&quot;:</span> <span class="pre">5</span></code>, then the function name
is <code class="docutils literal notranslate"><span class="pre">irq_5_init</span></code>.
If the manifest declares <code class="docutils literal notranslate"><span class="pre">&quot;source&quot;</span>&#160; <span class="pre">:</span> <span class="pre">&quot;TIMER_1_IRQ&quot;</span></code> then the function
name is <code class="docutils literal notranslate"><span class="pre">timer_1_irq_init</span></code>.</p>
<p>The function will be called by the Framework automatically during
initialization. The function can be put in any source file that belongs to SPM,
for example a <code class="docutils literal notranslate"><span class="pre">tfm_interrupts.c</span></code> added to the <code class="docutils literal notranslate"><span class="pre">tfm_spm</span></code> CMake target.</p>
<p>The initialization of an interrupt must include:</p>
<ul class="simple">
<li><p>setting the priority</p></li>
<li><p>ensuring that the interrupt targets the Secure State.</p></li>
<li><p>saving the interrupt information</p></li>
</ul>
<div class="section" id="setting-priority">
<h4>Setting Priority<a class="headerlink" href="#setting-priority" title="Permalink to this heading"></a></h4>
<p>The priority of external interrupts must be in the following range:
<code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">N</span> <span class="pre">/</span> <span class="pre">2)</span></code>, where <code class="docutils literal notranslate"><span class="pre">N</span></code> is the number of configurable priorities.
Smaller values have higher priorities.</p>
<p>For example if the number of configurable priority of your interrupt controller
is 16, you must use the priorities in range <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">8)</span></code> only, boundaries
excluded.</p>
<p>Note that these are not the values set into the interrupt controllers.
Different platforms may have different values for those priorities.
But if you use the <code class="docutils literal notranslate"><span class="pre">NVIC_SetPriority</span></code> function provided by CMSIS to set
priorities, you can pass the values directly.</p>
<p>Platforms have the flexibilities on the assignment of priorities.</p>
</div>
<div class="section" id="targeting-interrupts-to-secure">
<h4>Targeting Interrupts to Secure<a class="headerlink" href="#targeting-interrupts-to-secure" title="Permalink to this heading"></a></h4>
<p>In single core systems, platform integrators must ensure that the Secure
interrupts target to Secure State by setting the Interrupt Controller.</p>
<p>In multi-core systems, this might be optional.</p>
</div>
<div class="section" id="saving-the-interrupt-information">
<h4>Saving the Interrupt Information<a class="headerlink" href="#saving-the-interrupt-information" title="Permalink to this heading"></a></h4>
<p>The initialization function is called during Partition loading with the
following information:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">p_pt</span></code> - pointer to Partition runtime struct of the owner Partition</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p_ildi</span></code> - pointer to <code class="docutils literal notranslate"><span class="pre">irq_load_info_t</span></code> struct of the interrupt</p></li>
</ul>
<p>Platforms must save the information for the future use.
See <a class="reference internal" href="#integrating-the-interrupt-handling-function">Integrating the Interrupt Handling Function</a> for the usage.</p>
<p>The easiest way is to save them in global variables for each interrupt.
TF-M provides a struct for saving the information:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">irq_t</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">void</span><span class="w">                         </span><span class="o">*</span><span class="n">p_pt</span><span class="p">;</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">irq_load_info_t</span><span class="w"> </span><span class="o">*</span><span class="n">p_ildi</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="integrating-the-interrupt-handling-function">
<h3>Integrating the Interrupt Handling Function<a class="headerlink" href="#integrating-the-interrupt-handling-function" title="Permalink to this heading"></a></h3>
<p>TF-M provides an interrupt handling entry for Secure interrupts:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="n">spm_handle_interrupt</span><span class="p">(</span><span class="kt">void</span><span class="w"> </span><span class="o">*</span><span class="n">p_pt</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="nc">irq_load_info_t</span><span class="w"> </span><span class="o">*</span><span class="n">p_ildi</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">p_pt</span></code> and <code class="docutils literal notranslate"><span class="pre">p_ildi</span></code> are the information passed to interrupt
initialization functions and saved by platforms.</p>
<p>Platforms should call this entry function in the interrupt handlers held in
Vector Table with the information saved by the interrupt initialization
functions.
If the information is saved as global variables, then the interrupt handlers can
be put in the same source file that contains the initialization functions.</p>
<p>Here is an example:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">TFM_TIMER0_IRQ_Handler</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="w"> </span><span class="cm">/* The handler in Vector Table */</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">spm_handle_interrupt</span><span class="p">(</span><span class="n">p_timer0_pt</span><span class="p">,</span><span class="w"> </span><span class="n">p_tfm_timer0_irq_ldinf</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="enabling-the-interrupt-tests">
<h2>Enabling the Interrupt Tests<a class="headerlink" href="#enabling-the-interrupt-tests" title="Permalink to this heading"></a></h2>
<p>TF-M provides test suites for FLIH and SLIH interrupts respectively.
They are disabled by default.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>FLIH interrupt test and SLIH interrupt test share the same timer
<code class="docutils literal notranslate"><span class="pre">TFM_TIMER0_IRQ</span></code> thus cannot be enabled at the same time.</p>
</div>
<p>To enable the tests, please follow steps in the previous sections.
In addition, you need to implement the following APIs of timer control:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">tfm_plat_test_secure_timer_start(void)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">tfm_plat_test_secure_timer_clear_intr(void)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">void</span> <span class="pre">tfm_plat_test_secure_timer_stop(void)</span></code></p></li>
</ul>
<p>You shall also select the following flags in platform specific <code class="docutils literal notranslate"><span class="pre">config.cmake</span></code>
to indicate that FLIH and SLIH interrupt tests are supported respectively.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">PLATFORM_FLIH_IRQ_TEST_SUPPORT</span></code>: platform implements support of FLIH
interrupt tests</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">PLATFORM_SLIH_IRQ_TEST_SUPPORT</span></code>: platform implements support of SLIH
interrupt tests</p></li>
</ul>
<p>The following configurations control SLIH and FLIH interrupt tests:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TEST_NS_FLIH_IRQ</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TEST_NS_SLIH_IRQ</span></code></p></li>
</ul>
<p>They can be enabled via build command line or via <code class="docutils literal notranslate"><span class="pre">TEST_NS</span></code>.</p>
</div>
<div class="section" id="migrating-to-firmware-framework-v1-1">
<h2>Migrating to Firmware Framework v1.1<a class="headerlink" href="#migrating-to-firmware-framework-v1-1" title="Permalink to this heading"></a></h2>
<p>Please refer to <code class="docutils literal notranslate"><span class="pre">Migrating</span> <span class="pre">Secure</span> <span class="pre">Partitions</span> <span class="pre">to</span> <span class="pre">version</span> <span class="pre">1.1</span></code> of FF-M v1.1 <a class="footnote-reference brackets" href="#id7" id="id6">1</a>
.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this heading"></a></h2>
<dl class="footnote brackets">
<dt class="label" id="id7"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id3">2</a>,<a href="#id6">3</a>)</span></dt>
<dd><p><a class="reference external" href="https://developer.arm.com/documentation/den0063/latest/">FF-M v1.0 Specification</a></p>
</dd>
<dt class="label" id="id8"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p><a class="reference external" href="https://developer.arm.com/documentation/aes0039/latest/">FF-M v1.1 Extension</a></p>
</dd>
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p><a class="reference external" href="https://git.trustedfirmware.org/TF-M/tf-m-tests.git/tree/tests_reg/test/secure_fw/suites/spm/irq/service/tfm_flih_test_service">https://git.trustedfirmware.org/TF-M/tf-m-tests.git/tree/tests_reg/test/secure_fw/suites/spm/irq/service/tfm_flih_test_service</a></p>
</dd>
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id5">4</a></span></dt>
<dd><p><a class="reference external" href="https://git.trustedfirmware.org/TF-M/tf-m-tests.git/tree/tests_reg/test/secure_fw/suites/spm/irq/service/tfm_slih_test_service">https://git.trustedfirmware.org/TF-M/tf-m-tests.git/tree/tests_reg/test/secure_fw/suites/spm/irq/service/tfm_slih_test_service</a></p>
</dd>
</dl>
<hr class="docutils" />
<p><em>Copyright (c) 2021-2024, Arm Limited. All rights reserved.</em>
<em>Copyright (c) 2022 Cypress Semiconductor Corporation (an Infineon company)
or an affiliate of Cypress Semiconductor Corporation. All rights reserved.</em></p>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>