<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Trusted Firmware-M Generic Threat Model &mdash; Trusted Firmware-M v1.7.0-stm32mp25-alpha-r1-rc3-doc documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/tfm_custom.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Security Handling" href="../security.html" />
    <link rel="prev" title="Threat Models" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> Trusted Firmware-M
            <img src="../../_static/tf_logo_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v1.7.0-stm32mp25-alpha-r1-rc3-doc

              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">Introduction</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/index.html">Getting Started</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Security</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../security_advisories/index.html">Security Advisories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security_advisories/stack_seal_vulnerability.html">Advisory TFMV-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security_advisories/svc_caller_sp_fetching_vulnerability.html">Advisory TFMV-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security_advisories/crypto_multi_part_ops_abort_fail.html">Advisory TFMV-3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security_advisories/profile_small_key_id_encoding_vulnerability.html">Advisory TFMV-4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security_advisories/fwu_write_vulnerability.html">Advisory TFMV-5</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Threat Models</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Trusted Firmware-M Generic Threat Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security.html">Security Handling</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../releases/index.html">Releases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../releases/1.7.0.html">v1.7.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../releases/1.6.1.html">v1.6.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../releases/1.6.0.html">v1.6.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../releases/1.5.0.html">v1.5.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../releases/release_process.html">Release Cadence and Process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../platform/index.html">Platform Selection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../platform/arm/index.html">Arm platforms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../platform/arm/corstone1000/readme.html">Corstone-1000</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/arm/mps3/an547/README.html">Corstone-300 FPGA (AN547)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/arm/mps3/an552/README.html">Corstone-300 FPGA and FVP (AN552)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/arm/mps3/corstone310/README.html">Corstone-310 FVP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/arm/musca_b1/readme.html">Musca-B1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/arm/musca_s1/readme.html">Musca-S1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/arm/rss/readme.html">Runtime Security Subsystem</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../platform/nxp/lpcxpresso55s69/README.html">LPCXpresso55S69</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platform/cypress/psoc64/index.html">Cypress PSoC64</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../platform/cypress/psoc64/cypress_psoc64_spec.html">Cypress PSoC64 Specifics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/cypress/psoc64/libs/core-lib/README.html">Core Library</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/cypress/psoc64/libs/core-lib/RELEASE.html">Core Library Release Notes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../platform/stm/index.html">STMICROELECTRONICS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/common/stm32l5xx/readme.html">STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/common/stm32mp2/readme.html">STM32MP2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/common/stm32u5xx/readme.html">STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO-L552ZE-Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/stm32l562e_dk/readme.html">STM32L562E-DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/b_u585i_iot02a/readme.html">B-U585I-IOT02A</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../platform/nordic_nrf/nrf5340dk_nrf5340_cpuapp/README.html">Nordic nRF5340</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platform/nordic_nrf/nrf9160dk_nrf9160/README.html">Nordic nRF9160</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platform/lairdconnectivity/bl5340_dvk_cpuapp/README.html">Laird Connectivity BL5340</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platform/nuvoton/m2351/README.html">NuMaker-PFM-M2351</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platform/nuvoton/m2354/README.html">NuMaker-PFM-M2354</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../building/tfm_build_instruction.html">Build instructions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../building/run_tfm_examples_on_arm_platforms.html">Run TF-M examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../building/documentation_generation.html">Building the documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../building/tfm_build_instruction_iar.html">IAR toolchain</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration/index.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../configuration/build_configuration.html">Build configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../configuration/header_file_system.html">Component configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../configuration/kconfig_system.html">Kconfig</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../configuration/profiles/index.html">Profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/profiles/tfm_profile_small.html"> Small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/profiles/tfm_profile_medium_arot-less.html"> ARoT-less</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/profiles/tfm_profile_medium.html"> Medium</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../configuration/profiles/tfm_profile_large.html"> Large</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../configuration/test_configuration.html">Tests configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../integration_guide/index.html">Integration Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../integration_guide/spm_backends.html">SPM Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integration_guide/non-secure_client_extension_integration_guide.html">NS client integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integration_guide/os_migration_guide_armv8m.html">OS migration to Armv8-M</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integration_guide/tfm_fpu_support.html">Floating-Point Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integration_guide/tfm_secure_irq_integration_guide.html">Secure Interrupt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../integration_guide/platform/index.html">Adding a new platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/platform/platform_folder.html">Details for the platform folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/platform/platform_ext_folder.html">Details for the platform/ext folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/platform/porting_TFM_to_a_new_hardware.html">Porting TF-M to a New Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/platform/platform_provisioning.html">Platform Provisioning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/platform/platform_deprecation.html">Platform deprecation and removal</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../integration_guide/services/index.html">Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/services/tfm_attestation_integration_guide.html">Initial Attestation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/services/tfm_crypto_integration_guide.html">Crypto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/services/tfm_its_integration_guide.html">Internal Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/services/tfm_platform_integration_guide.html">Platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/services/tfm_ps_integration_guide.html">Protected Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/services/tfm_secure_partition_addition.html">Adding a New Service</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../integration_guide/services/tfm_manifest_tool_user_guide.html">The manifest tool</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../technical_references/design_docs/index.html">Design Documents</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/dual-cpu/index.html">Dual-CPU</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../technical_references/design_docs/dual-cpu/booting_a_dual_core_system.html">Booting a Dual-Core System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../technical_references/design_docs/dual-cpu/communication_prototype_between_nspe_and_spe_in_dual_core_systems.html">Communication Prototype Between NSPE And SPE In Dual Core System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../technical_references/design_docs/dual-cpu/mailbox_design_on_dual_core_system.html">Mailbox Design in TF-M on Dual-core System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../technical_references/design_docs/dual-cpu/tfm_multi_core_access_check.html">Memory Access Check of Trusted Firmware-M in Multi-Core Topology</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/bl1.html">BL1 Immutable bootloader</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/code_sharing.html">Code sharing between independently linked XIP binaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/enum_implicit_casting.html">Fixing implicit casting for C enumeration values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/ff_isolation.html">FF-M Isolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/hardware_abstraction_layer.html">Hardware Abstraction Layer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/mailbox_ns_agent_update.html">Mailbox NS Agent Design Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/ps_key_management.html">Protected Storage service key management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/secure_boot_hw_key_integration.html">HW crypto key integration in TF-M secure boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/secure_boot_rollback_protection.html">Rollback protection in TF-M secure boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/secure_partition_manager.html">Secure Partition Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/source_structure.html">Trusted Firmware-M Source Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/stateless_rot_service.html">Stateless Root of Trust Services Reference</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/symmetric_initial_attest.html">Symmetric key algorithm based Initial Attestation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_builtin_keys.html">TF-M builtin keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_code_generation_with_jinja2.html">Code Generation With Jinja2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_cooperative_scheduling_rules.html">Cooperative Scheduling Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_crypto_design.html">Crypto Service design</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_fwu_service.html">Firmware Update Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_its_512_flash.html">Add support for block-aligned flash in Internal Trusted Storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_its_service.html">Internal Trusted Storage (ITS) Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_log_system_design_document.html">Log system design document</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_physical_attack_mitigation.html">Physical attack mitigation in Trusted Firmware-M</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_psa_inter_process_communication.html">TF-M Inter-Process Communication</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_secure_boot.html">Secure boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_secure_partition_runtime_library.html">Secure Partition Runtime Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technical_references/design_docs/tfm_uniform_secure_service_signature.html">Uniform Secure Service Signature</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Guidelines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/contributing_process.html">The process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/code_review_guide.html">Code review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/maintainers.html">Maintainers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/maintainers.html#code-owners">Code owners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/coding_guide.html">Yet another coding standard :)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/doc_guidelines.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../contributing/tfm_design_proposal_guideline.html">Design proposal</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/lic.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/dco.html">DCO</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://ci.trustedfirmware.org/view/TF-M/job/tf-m-build-docs-nightly/lastSuccessfulBuild/artifact/trusted-firmware-m/build/docs/reference_manual/html/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.trustedfirmware.org/w/collaboration/security_center">Security Center</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.arm.com/architecture/security-features/platform-security">PSA</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">STMICROELECTRONICS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../stm/releases/index.html">Releases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stm/releases/getting_started.html">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/stm32l562e_dk/readme.html">STM32L562E-DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO-L552ZE-Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/b_u585i_iot02a/readme.html">B-U585I-IOT02A</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../stm/releases/platforms.html">Platforms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/common/stm32l5xx/readme.html">STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/common/stm32mp2/readme.html">STM32MP2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/common/stm32u5xx/readme.html">STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO-L552ZE-Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/stm32l562e_dk/readme.html">STM32L562E-DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../stm/releases/changelog.html">Change Log &amp; Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stm/releases/v1.7.0-stm32mp25-alpha-r1-rc3/changelog.html">v1.7.0-stm32mp25-alpha-r1-rc3</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../stm/technical/index.html">Technical references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stm/technical/a35_td_flavor/index.html">A35-TD flavor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stm/technical/a35_td_flavor/memory_layout.html">Memory layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stm/technical/a35_td_flavor/storage.html">Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../stm/technical/m33_td_flavor/index.html">M33-TD flavor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stm/technical/m33_td_flavor/memory_layout.html">Memory layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stm/technical/m33_td_flavor/storage.html">Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../stm/technical/devicetree/index.html">Devicetree</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../stm/technical/devicetree/devicetree_tfm.html">Scope and purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stm/technical/devicetree/devicetree_tfm.html#concept">Concept</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../stm/technical/devicetree/devicetree_tfm.html#how-to-add-device">How to add device</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../stm/technical/initlevel.html">Initlevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stm/technical/initial_attestation.html">Initial Attestation Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../stm/technical/nv_counter.html">Nv counter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../stm/ide/index.html">Ide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../stm/ide/cubeide/stm32cubeide.html">STM32CubeIDE</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Trusted Firmware-M</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Security</a> &raquo;</li>
          <li><a href="index.html">Threat Models</a> &raquo;</li>
      <li>Trusted Firmware-M Generic Threat Model</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="trusted-firmware-m-generic-threat-model">
<h1>Trusted Firmware-M Generic Threat Model<a class="headerlink" href="#trusted-firmware-m-generic-threat-model" title="Permalink to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>This document introduces a generic threat model of Trusted Firmware-M (TF-M).
This generic threat model provides an overall analysis of TF-M implementation
and identifies general threats and mitigation.</p>
<p>There is also a dedicated document for physical attacks mitigations which can be found
<a class="reference internal" href="../../technical_references/design_docs/tfm_physical_attack_mitigation.html"><span class="doc">here</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you think a security vulnerability is found, please follow
Trustedfirmware.org <a class="reference internal" href="#security-incident-process" id="id1"><span>[Security-Incident-Process]</span></a> to contact TF-M security
team.</p>
</div>
<section id="scope">
<h3>Scope<a class="headerlink" href="#scope" title="Permalink to this heading"></a></h3>
<p>TF-M supports diverse models and topologies. It also implements multiple
isolation levels. Each case may focus on different target of evaluation (TOE)
and identify different assets and threats.
TF-M implementation consists of several secure services, defined as
Root of Trust (RoT) service. Those RoT services belong to diverse RoT
(Application RoT or PSA RoT) and access different assets and hardware. Therefore
each RoT service may require a dedicated threat model.</p>
<p>The analysis on specific models, topologies or RoT services may be covered in
dedicated threat model documents. Those threat models are out of the scope of
this document.</p>
</section>
<section id="methodology">
<h3>Methodology<a class="headerlink" href="#methodology" title="Permalink to this heading"></a></h3>
<p>The threat modeling in this document follows the process listed below to
build up the threat model.</p>
<ul class="simple">
<li><p>Target of Evaluation (TOE)</p></li>
<li><p>Assets identification</p></li>
<li><p>Data Flow Diagram (DFD)</p></li>
<li><p>Threats Prioritization</p></li>
<li><p>Threats identification</p></li>
</ul>
<p>TOE is the entity on which threat modeling is performed. The logic behind this
process is to firstly investigate the TOE which could be a system, solution or
use case. This first step helps to identify the assets to be protected in TOE.</p>
<p>According to TOE and assets, Trust Boundaries can be determined. The Data Flow
Diagram (DFD) across Trust Boundaries is then defined to help identify the
threats.</p>
<p>Those threats should be prioritized based on a specific group of principals and
metrics. The principals and metrics should also be specified.</p>
</section>
</section>
<section id="target-of-evaluation">
<h2>Target of Evaluation<a class="headerlink" href="#target-of-evaluation" title="Permalink to this heading"></a></h2>
<p>A typical TF-M system diagram from a high-level overview is shown below. TF-M is
running in the Secure Processing Environment (SPE) and NS software is running in
Non-secure Processing Environment (NSPE). For more details, please refer to
Platform Security Architecture Firmware Framework for M (FF-M) <a class="reference internal" href="#ff-m" id="id2"><span>[FF-M]</span></a> and
FF-M 1.1 Extensions [FF-M 1.1 Extensions]_.</p>
<figure class="align-default">
<img alt="../../_images/TF-M-block-diagram.png" src="../../_images/TF-M-block-diagram.png" />
</figure>
<p>The TOE in this general model is the SPE, including TF-M and other components
running in SPE.</p>
<p>The TOE can vary in different TF-M models, RoT services and usage scenarios.
Refer to dedicated threat models for the specific TOE definitions.</p>
</section>
<section id="asset-identification">
<h2>Asset identification<a class="headerlink" href="#asset-identification" title="Permalink to this heading"></a></h2>
<p>In this threat model, assets include the general items listed below:</p>
<ul>
<li><p>Hardware Root of Trust data, e.g.</p>
<blockquote>
<div><ul class="simple">
<li><p>Hardware Unique Key (HUK)</p></li>
<li><p>Root authentication key</p></li>
<li><p>Other embedded root keys</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Software RoT data, e.g.</p>
<blockquote>
<div><ul class="simple">
<li><p>Secure Partition Manager (SPM) code and data</p></li>
<li><p>Secure partition code and data</p></li>
<li><p>NSPE data stored in SPE</p></li>
<li><p>Data generated in SPE as requested by NSPE</p></li>
</ul>
</div></blockquote>
</li>
<li><p>Availability of entire RoT service</p></li>
<li><p>Secure logs, including event logs</p></li>
</ul>
<p>Assets may vary in different use cases and implementations. Additional assets
can be defined in an actual usage scenario and a dedicated threat model.</p>
<p>For example, in a network camera use case, the following data can be defined as
assets too:</p>
<ul class="simple">
<li><p>Certificate for connecting to cloud</p></li>
<li><p>Session keys for encryption/decryption in the communication with cloud</p></li>
<li><p>Keys to encrypt/decrypt the videos and photos</p></li>
</ul>
</section>
<section id="data-flow-diagram">
<h2>Data Flow Diagram<a class="headerlink" href="#data-flow-diagram" title="Permalink to this heading"></a></h2>
<p>The Trust Boundary isolates SPE from NSPE, according to the TOE definition in
<a class="reference internal" href="#target-of-evaluation">Target of Evaluation</a>. The Trust Boundary mapped to block diagram is shown
in the figure below. Other modules inside SPE stay in the same TOE as TF-M does.</p>
<p>Valid Data flows across the Trust Boundary are also shown in the figure below.
This threat model only focuses on the data flows related to TF-M.</p>
<figure class="align-default">
<img alt="../../_images/overall-DFD.png" src="../../_images/overall-DFD.png" />
</figure>
<p>More details of data flows are listed below.</p>
<span id="data-flow-table"></span><table class="docutils align-default" id="id20">
<caption><span class="caption-number">Table 1: </span><span class="caption-text">TF-M Data Flows between NSPE and SPE</span><a class="headerlink" href="#id20" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 15%" />
<col style="width: 85%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Data flow</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DF1</span></code></p></td>
<td><p>TF-M initializes NS entry and activates NSPE.</p>
<ul class="simple">
<li><p>On single Armv8-M core platforms, TF-M will hand over the
control to Non-secure state.</p></li>
<li><p>On dual-cpu platforms, Secure core starts NS core booting.</p></li>
</ul>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DF2</span></code></p></td>
<td><p>NSPE requests TF-M RoT services.</p>
<p>NSPE requests RoT services via PSA Client APIs defined in
<a class="reference internal" href="#ff-m" id="id3"><span>[FF-M]</span></a>.</p>
<p>In single Armv8-M core scenarios, SG instruction is executed
in Non-secure Callable region to trigger a transition from
Non-secure state to Secure state.</p>
<p>On dual-cpu platforms, non-secure core sends PSA Client calls
to secure core via mailbox.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DF3</span></code></p></td>
<td><p>Secure Partitions fetch input data from NS and write back
output data to NS.</p>
<p>As required in <a class="reference internal" href="#ff-m" id="id4"><span>[FF-M]</span></a>, Secure Partitions should not directly
access NSPE memory. Instead, RoT services relies on TF-M SPM
to access NSPE memory.</p>
</td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DF4</span></code></p></td>
<td><p>TF-M returns RoT service results to NSPE after NS request to
RoT service is completed.</p>
<p>In single Armv8-M core scenarios, it also trigger a transition
from Secure state back to Non-secure state.</p>
<p>On dual-cpu platforms, secure core returns the result to
non-secure core via mailbox.</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">DF5</span></code></p></td>
<td><p>Non-secure interrupts preempt SPE execution in single Armv8-M
core scenarios.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">DF6</span></code></p></td>
<td><p>Secure interrupts preempt NSPE execution in single Armv8-M
core scenarios.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All the other data flows across the Trusted Boundary besides the valid ones
mentioned above should be prohibited by default.
Proper isolation must be configured to prevent NSPE directly accessing SPE.</p>
<p>Threats irrelevant to data flows in
<a class="reference internal" href="#data-flow-table"><span class="std std-ref">TF-M Data Flows between NSPE and SPE</span></a> may be specified
in <a class="reference internal" href="#miscellaneous-threats">Miscellaneous threats</a>.</p>
</div>
<section id="data-flows-inside-spe-informative">
<h3>Data flows inside SPE (informative)<a class="headerlink" href="#data-flows-inside-spe-informative" title="Permalink to this heading"></a></h3>
<p>Since all the SPE components stay in the TOE within the same Trust Boundary in
this threat model, the data flows between SPE components are not covered in this
threat model. Instead, those data flows and corresponding threats will be
identified in the dedicated threat model documents of TF-M RoT services and
usage scenarios.</p>
<p>Those data flows inside SPE include following examples:</p>
<ul class="simple">
<li><p>Data flows between TF-M and BL2</p></li>
<li><p>Data flows between RoT services and SPM</p></li>
<li><p>Data flows between RoT services and corresponding secure hardware and assets,
such as secure storage device, crypto hardware accelerator and Hardware Unique
Key (HUK).</p></li>
</ul>
</section>
</section>
<section id="threat-identification">
<h2>Threat identification<a class="headerlink" href="#threat-identification" title="Permalink to this heading"></a></h2>
<section id="threat-priority">
<h3>Threat priority<a class="headerlink" href="#threat-priority" title="Permalink to this heading"></a></h3>
<p>Threat priority is indicated by the score calculated via Common Vulnerability
Scoring System (CVSS) Version 3.1 <a class="reference internal" href="#cvss" id="id5"><span>[CVSS]</span></a>. The higher the threat scores, the
greater severity the threat is with and the higher the priority is.</p>
<p>CVSS scores can be mapped to qualitative severity ratings defined in CVSS 3.1
specification <a class="reference internal" href="#cvss-spec" id="id6"><span>[CVSS_SPEC]</span></a>. This threat model follows the same mapping between
CVSS scores and threat priority rating.</p>
<p>As a generic threat model, this document focuses on <em>Base Score</em> which reflects
the constant and general severity of a threat according to its intrinsic
characteristics.</p>
<p>The <em>Impacted Component</em> defined in <a class="reference internal" href="#cvss-spec" id="id7"><span>[CVSS_SPEC]</span></a> refers to the assets listed in
<a class="reference internal" href="#asset-identification">Asset identification</a>.</p>
</section>
<section id="threats-and-mitigation-list">
<h3>Threats and mitigation list<a class="headerlink" href="#threats-and-mitigation-list" title="Permalink to this heading"></a></h3>
<p>This section lists generic threats and corresponding mitigation, based on the
the analysis of data flows in <a class="reference internal" href="#data-flow-diagram">Data Flow Diagram</a>.</p>
<p>Threats are identified following <code class="docutils literal notranslate"><span class="pre">STRIDE</span></code> model. Please refer to <a class="reference internal" href="#stride" id="id8"><span>[STRIDE]</span></a> for
more details.</p>
<p>The field <code class="docutils literal notranslate"><span class="pre">CVSS</span> <span class="pre">Score</span></code> reflects the threat priority defined in
<a class="reference internal" href="#threat-priority">Threat priority</a>. The field <code class="docutils literal notranslate"><span class="pre">CVSS</span> <span class="pre">Vector</span> <span class="pre">String</span></code> contains the textual
representation of the CVSS metric values used to score the threat. Refer to
<a class="reference internal" href="#cvss-spec" id="id9"><span>[CVSS_SPEC]</span></a> for more details of CVSS vector string.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A generic threat may have different behaviors and therefore require different
mitigation, in diverse TF-M models and usage scenarios.</p>
<p>This threat model document focuses on general analysis of the following
threats. For the details in a specific configuration and usage scenario,
please refer to the dedicated threat model document.</p>
</div>
<section id="ns-entry-initialization">
<h4>NS entry initialization<a class="headerlink" href="#ns-entry-initialization" title="Permalink to this heading"></a></h4>
<p>This section identifies threats on <code class="docutils literal notranslate"><span class="pre">DF1</span></code> defined in <a class="reference internal" href="#data-flow-diagram">Data Flow Diagram</a>.</p>
<table class="colwidths-given docutils align-default" id="id21">
<caption><span class="caption-number">Table 2: </span><span class="caption-text">TFM-GENERIC-NS-INIT-T-1</span><a class="headerlink" href="#id21" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-NS-INIT-T-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>The NS image can be tampered by an attacker</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>An attack may tamper the NS image to inject malicious code</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Tampering</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>By default TF-M relies on MCUBoot to validate NS image.
The validation of NS image integrity and authenticity is
completed in secure boot before jumping to NS entry or
booting up NS core.
Refer to <a class="reference internal" href="#secure-boot" id="id10"><span>[SECURE-BOOT]</span></a> for more details.</p>
<p>The validation may vary in diverse vendor platforms
specific Chain of Trust (CoT) implementation.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>3.5 (Low)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id22">
<caption><span class="caption-number">Table 3: </span><span class="caption-text">TFM-GENERIC-NS-INIT-T-2</span><a class="headerlink" href="#id22" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-NS-INIT-T-2</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>An attacker may replace the current NS image with an older
version.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>The attacker downgrades the NS image with an older version
which has been deprecated due to known security issues.</p>
<p>The older version image can pass the image signature
validation and its vulnerabilities can be exploited by
attackers.</p>
</td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Tampering</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>TF-M relies on MCUBoot to perform anti-rollback
protection.</p>
<p>TF-M defines a non-volatile counter API to support
anti-rollback. Each platform must implement it using
specific trusted hardware non-volatile counters.
For more details, refer to <a class="reference internal" href="#rollback-protect" id="id11"><span>[ROLLBACK-PROTECT]</span></a>.</p>
<p>The anti-rollback protection implementation can vary on
diverse platforms.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>3.5 (Low)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:P/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id23">
<caption><span class="caption-number">Table 4: </span><span class="caption-text">TFM-GENERIC-NS-INIT-T-I-1</span><a class="headerlink" href="#id23" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-NS-INIT-T-I-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>If SPE doesn’t complete isolation configuration before
NSPE starts, NSPE can access secure regions which it is
disallowed to.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>Secure data can be tampered or disclosed if NSPE is
activated and accesses secure regions before isolation
configuration is completed by SPE.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Tampering/Information disclosure</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>SPE must complete and enable proper isolation to protect
secure regions from being accessed by NSPE, before jumping
to NS entry or booting up NS core.</p>
<p>TF-M executes isolation configuration at early stage of
secure initialization before NS initialization starts.</p>
<p>On dual-cpu platform, platform specific initialization
must halt NS core until isolation is completed, as defined
in <a class="reference internal" href="#dual-cpu-boot" id="id12"><span>[DUAL-CPU-BOOT]</span></a>.</p>
<p>TF-M defines isolation configuration HALs for platform
implementation. The specific isolation configuration
depends on platform specific implementation.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>9.0 (Critical)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id24">
<caption><span class="caption-number">Table 5: </span><span class="caption-text">TFM-GENERIC-NS-INIT-T-I-2</span><a class="headerlink" href="#id24" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-NS-INIT-T-I-2</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>If SPE doesn’t complete isolation configuration before
NSPE starts, NSPE can control devices or peripherals which
it is disallowed to.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>On some platforms, devices and peripherals can be
configured as Secure state in runtime. If security status
configuration of those device and peripherals are not
properly completed before NSPE starts, NSPE can control
those device and peripherals and may be able to tamper
data or access secure data.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Tampering/Information disclosure</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>SPE must complete and enable proper configuration and
isolation to protect critical devices and peripherals from
being accessed by NSPE, before jumping to NS entry or
booting up NS core.</p>
<p>TF-M executes isolation configuration of devices and
peripherals at early stage of secure initialization before
NS initialization starts.</p>
<p>The specific isolation configuration depends on platform
specific implementation.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>9.0 (Critical)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id25">
<caption><span class="caption-number">Table 6: </span><span class="caption-text">TFM-GENERIC-NS-INIT-I-2</span><a class="headerlink" href="#id25" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-NS-INIT-I-2</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>If SPE leaves some SPE information in non-secure memory
or shared registers when NSPE starts, NSPE may access
those SPE information.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>If NSPE can access those SPE information from shared
registers or non-secure memory, secure information may be
disclosed.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Information disclosure</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>SPE must clean up the secure information from shared
registers before NS starts.</p>
<p>TF-M invalidates registers not banked before handing over
the system to NSPE on single Armv8-M platform.</p>
<p>On dual-cpu platforms, shared registers are implementation
defined, such as Inter-Processor Communication registers.
Dual-cpu platforms must not store any data which may
disclose secure information in the shared registers.</p>
<p>SPE must avoid storing SPE information in non-secure
memory.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>4.3 (Medium)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id26">
<caption><span class="caption-number">Table 7: </span><span class="caption-text">TFM-GENERIC-NS-INIT-D-1</span><a class="headerlink" href="#id26" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-NS-INIT-D-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>An attacker may block NS to boot up</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>An attacker may block NS to boot up, such as by corrupting
NS image, to stop the whole system from performing normal
functionalities.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Denial of service</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>No SPE information will be disclosed and TF-M won’t be
directly impacted.</p>
<p>It relies on NSPE and platform specific implementation to
mitigate this threat. It is out of scope of this threat
model.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>4.0 (Medium)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</p></td>
</tr>
</tbody>
</table>
</section>
<section id="nspe-requests-tf-m-secure-service">
<h4>NSPE requests TF-M secure service<a class="headerlink" href="#nspe-requests-tf-m-secure-service" title="Permalink to this heading"></a></h4>
<p>This section identifies threats on <code class="docutils literal notranslate"><span class="pre">DF2</span></code> defined in <a class="reference internal" href="#data-flow-diagram">Data Flow Diagram</a>.</p>
<table class="colwidths-given docutils align-default" id="id27">
<caption><span class="caption-number">Table 8: </span><span class="caption-text">TFM-GENERIC-REQUEST-SERVICE-S-1</span><a class="headerlink" href="#id27" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-REQUEST-SERVICE-S-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>A malicious NS application may pretend as a secure client
to access secure data which NSPE must not directly access.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p><a class="reference internal" href="#ff-m" id="id13"><span>[FF-M]</span></a> defines <code class="docutils literal notranslate"><span class="pre">Client</span> <span class="pre">ID</span></code> to distinguish clients which
request RoT services. Secure clients are assigned with
positive IDs and non-secure clients are assigned with
negative ones.</p>
<p>A malicious NS application may provide a positive
<code class="docutils literal notranslate"><span class="pre">Client</span> <span class="pre">ID</span></code> to pretend as a secure client to access
secure data.</p>
</td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Spoofing</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>TF-M checks the <code class="docutils literal notranslate"><span class="pre">Client</span> <span class="pre">ID</span></code> from NSPE. If the NS
<code class="docutils literal notranslate"><span class="pre">Client</span> <span class="pre">ID</span></code> is not a valid one, TF-M will report this as
a security error.</p></td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>8.4 (High)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id28">
<caption><span class="caption-number">Table 9: </span><span class="caption-text">TFM-GENERIC-REQUEST-SERVICE-T-1</span><a class="headerlink" href="#id28" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-REQUEST-SERVICE-T-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>An attacker in NSPE may tamper the service request input
or output vectors between check and use
(Time-Of-Check-to-Time-Of-Use (TOCTOU)).</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>If SPE validates the content in input/output vectors
locally in NSPE memory, an attacker in NSPE can have a
chance to tamper the content after the validation
successfully passes. Then SPE will provide RoT service
according to the corrupted parameters and it may cause
further security issues.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Tampering</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>In TF-M implementation, the validation of NS input/output
vectors are only executed after those vectors are copied
from NSPE into SPE. It prevents an attack from NSPE to
tamper those parameters after validation in TF-M.</p></td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>7.8 (High)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id29">
<caption><span class="caption-number">Table 10: </span><span class="caption-text">TFM-GENERIC-REQUEST-SERVICE-T-2</span><a class="headerlink" href="#id29" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-REQUEST-SERVICE-T-2</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>A malicious NS application may request to tamper data
belonging to SPE.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>A malicious NS application may request SPE RoT services to
write malicious value to SPE data. The malicious NS
application may try to tamper SPE assets, such as keys, or
modify configurations in SPE. The SPE data belongs to
components in SPE and must not be accessed by NSPE.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Tampering</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>TF-M executes memory access check to all the RoT service
requests. If a request doesn’t have enough permission to
access the target memory region, TF-M will refuse this
request and assert a security error.</p></td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>7.1 (High)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id30">
<caption><span class="caption-number">Table 11: </span><span class="caption-text">TFM-GENERIC-REQUEST-SERVICE-R-1</span><a class="headerlink" href="#id30" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-REQUEST-SERVICE-R-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>A NS application may repudiate that it has requested
services from a RoT service.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>A malicious NS application may call a RoT service to
access critical data in SPE, which it is disallowed to,
via a non-public vulnerability. It may refuse to admit
that it has accessed that data.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Repudiation</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>TF-M implements an event logging secure service to record
the critical events, such as the access to critical data.</p></td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>0.0 (None)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:N/I:N/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id31">
<caption><span class="caption-number">Table 12: </span><span class="caption-text">TFM-GENERIC-REQUEST-SERVICE-I-1</span><a class="headerlink" href="#id31" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-REQUEST-SERVICE-I-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>A malicious NS application may request to read data
belonging to SPE.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>A malicious NS application may request SPE RoT services to
copy SPE data to NS memory. The SPE data belongs to
components in SPE and must not be disclosed to NSPE, such
as root keys.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Information disclosure</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>TF-M executes memory access check to all the RoT service
requests. If a request doesn’t have enough permission to
access the target memory region, TF-M will refuse this
request and assert a security error.</p></td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>7.1 (High)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id32">
<caption><span class="caption-number">Table 13: </span><span class="caption-text">TFM-GENERIC-REQUEST-SERVICE-T-I-1</span><a class="headerlink" href="#id32" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-REQUEST-SERVICE-T-I-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>A malicious NS application may request to control secure
device and peripherals, on which it doesn’t have the
permission.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>A malicious NS application may request RoT services to
control secure device and peripherals, on which it doesn’t
have the permission.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Tampering/Information disclose</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>TF-M performs client check to validate whether the client
has the permission to access the secure device and
peripherals.</p></td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>9.0 (Critical)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id33">
<caption><span class="caption-number">Table 14: </span><span class="caption-text">TFM-GENERIC-REQUEST-SERVICE-D-1</span><a class="headerlink" href="#id33" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-REQUEST-SERVICE-D-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>A Malicious NS applications may frequently call secure
services to block secure service requests from other NS
applications.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>TF-M runs on IoT devices with constrained resource. Even
though multiple outstanding NS PSA Client calls can be
supported in system, the number of NS PSA client calls
served by TF-M simultaneously are still limited.</p>
<p>Therefore, if a malicious NS application or multiple
malicious NS applications continue calling TF-M secure
services frequently, it may block other NS applications to
request secure service from TF-M.</p>
</td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Denial of service</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>TF-M is unable to manage behavior of NS applications.
Assets are not disclosed and TF-M is neither directly
impacted in this threat.</p>
<p>It relies on NS OS to enhance scheduling policy and
prevent a single NS application to occupy entire CPU time.
It is beyond the scope of this threat model.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>4.0 (Medium)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id34">
<caption><span class="caption-number">Table 15: </span><span class="caption-text">TFM-GENERIC-REQUEST-SERVICE-D-2</span><a class="headerlink" href="#id34" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-REQUEST-SERVICE-D-2</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>A malicious NS application may provide invalid NS memory
addresses as the addresses of input and output data in RoT
service requests.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>SPE may be unable to achieve full knowledge of NS memory
mapping. SPE may fail to capture those invalid NS memory
addresses during memory access check since those invalid
addresses may not be included in isolation configuration.</p>
<p>In that case, SPE will access those invalid NS memory
addresses later to read or write data. It may trigger a
system error to crash the whole system immediately.</p>
<p>The malicious NS application may be blocked by NS MPU from
directly accessing that invalid NS memory address. But it
may manipulate SPE to access that address instead.</p>
</td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Denial of service</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>TF-M executes memory access check to the memory addresses
in all the NS requests.</p>
<p>On single Armv8-M core platforms, TF-M invokes <code class="docutils literal notranslate"><span class="pre">TT</span></code>
instructions to execute memory address check. If a NS
memory area is not matched in any valid SAU or MPU region,
it will be marked as invalid and any access permission is
disallowed. Therefore, SPM will reject any NS request
containing invalid NS memory addresses and reports it as
as a security error.</p>
<p>On dual-core platforms, TF-M implements a default memory
access check. If a NS memory area is not found in any
memory region configured for isolation, it will be marked
as invalid and therefore SPM will reject the corresponding
NS request. It will be reported as a security error.</p>
<p>Dual-core platforms may implement platform specific memory
check to replace the default one. It relies on platform
specific implementation to capture invalid memory address.
It is out of the scope of this document.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>3.2 (Low)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:N/I:N/A:L</p></td>
</tr>
</tbody>
</table>
</section>
<section id="rot-services-read-and-write-ns-data">
<h4>RoT services read and write NS data<a class="headerlink" href="#rot-services-read-and-write-ns-data" title="Permalink to this heading"></a></h4>
<p>This section identifies threats on <code class="docutils literal notranslate"><span class="pre">DF3</span></code> defined in <a class="reference internal" href="#data-flow-diagram">Data Flow Diagram</a>.</p>
<p>RoT services can either directly access NS memory or rely on TF-M SPM to obtain NS input data and
send response data back to NS memory.</p>
<span id="tfm-generic-secure-service-rw-t-1"></span><table class="colwidths-given docutils align-default" id="id35">
<caption><span class="caption-number">Table 16: </span><span class="caption-text">TFM-GENERIC-SECURE-SERVICE-RW-T-1</span><a class="headerlink" href="#id35" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-SECURE-SERVICE-RW-T-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>An attacker may tamper NS input data while the RoT service
is processing those data.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>A RoT service may access NS input data multiple times
during its data processing. For example, it may validate
or authenticate the NS input data before it performs
further processing.</p>
<p>If the NS input data remains in NSPE memory during the RoT
service execution, an attacker may tamper the NS input
data in NSPE memory after the validation passes.</p>
</td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Tampering</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>If RoT services request SPM to read and write NS data.
TF-M SPM follows <a class="reference internal" href="#ff-m" id="id14"><span>[FF-M]</span></a> to copy the NS input data into
SPE memory region owned by the RoT service, before the RoT
service processes the data.
Therefore, the NS input data is protected during the RoT
service execution from being tampered.</p>
<p>If RoT services can directly access NS memory and read NS
input data multiple times during data processing, it is
required to review and confirm the implementation of the
RoT service copies NS input data into SPE memory area
before it processes the data.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>3.2 (Low)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:N</p></td>
</tr>
</tbody>
</table>
<span id="tfm-generic-secure-service-rw-t-2"></span><table class="colwidths-given docutils align-default" id="id36">
<caption><span class="caption-number">Table 17: </span><span class="caption-text">TFM-GENERIC-SECURE-SERVICE-RW-T-2</span><a class="headerlink" href="#id36" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-SECURE-SERVICE-RW-T-2</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>A malicious NS application may embed secure memory
addresses into a structure in RoT service request input
vectors, to tamper secure memory which the NS application
must not access.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p><a class="reference internal" href="#ff-m" id="id15"><span>[FF-M]</span></a> limits the total number of input/output vectors to
4. If a RoT service requires more input/output vectors, it
may define a parameter structure which embeds multiple
input/output buffers addresses.</p>
<p>However, as a potential security risk, a malicious NS
application can put secure memory addresses into a valid
parameter structure to bypass TF-M validation on those
memory addresses.</p>
<p>The parameter structure can pass TF-M memory access check
since itself is valid. However, if the RoT service parses
the structure and directly write malicious data from NSPE
to the secure memory addresses in parameter structure, the
secure data will be tampered.</p>
</td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Tampering</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>It should be avoided to embed memory addresses into a
single input/output vector. If more than 4 memory
addresses are required in a RoT service request, it is
recommended to split this request into two or multiple
service calls and therefore each service call requires no
more than 4 input/output vectors.</p>
<p>If RoT services request SPM to read and write NS data.
SPM will validate the target addresses and can detect the
invalid addresses to mitigate this threat.</p>
<p>If RoT services can directly access NS memory, it is
required to review and confirm the implementation of RoT
service request doesn’t embed memory addresses.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>7.1 (High)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:N/I:H/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id37">
<caption><span class="caption-number">Table 18: </span><span class="caption-text">TFM-GENERIC-SECURE-SERVICE-RW-I-1</span><a class="headerlink" href="#id37" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-SECURE-SERVICE-RW-I-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Similar to <a class="reference internal" href="#tfm-generic-secure-service-rw-t-2">TFM-GENERIC-SECURE-SERVICE-RW-T-2</a>, a malicious
NS application can embed secure memory addresses in a
parameter structure in RoT service request input vectors,
to read secure data which the NS application must not
access.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>Similar to the description in
<a class="reference internal" href="#tfm-generic-secure-service-rw-t-2">TFM-GENERIC-SECURE-SERVICE-RW-T-2</a>, the secure memory
addresses hidden in the RoT service input/output vector
structure may bypass TF-M validation. Without a proper
check, the RoT service may copy secure data to NSPE
according to the secure memory addresses in structure,
secure information can be disclosed.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Information disclosure</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>It should be avoided to embed memory addresses into a
single input/output vector. If more than 4 memory
addresses are required in a RoT service request, it is
recommended to split this request into two or multiple
service calls and therefore each service call requires no
more than 4 input/output vectors.</p>
<p>If RoT services request SPM to read and write NS data.
SPM will validate the target addresses and can detect the
invalid addresses to mitigate this threat.</p>
<p>If RoT services can directly access NS memory, it is
required to review and confirm the implementation of RoT
service request doesn’t embed memory addresses.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>7.1 (High)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N</p></td>
</tr>
</tbody>
</table>
</section>
<section id="tf-m-returns-secure-service-result">
<h4>TF-M returns secure service result<a class="headerlink" href="#tf-m-returns-secure-service-result" title="Permalink to this heading"></a></h4>
<p>This section identifies threats on <code class="docutils literal notranslate"><span class="pre">DF4</span></code> defined in <a class="reference internal" href="#data-flow-diagram">Data Flow Diagram</a>.</p>
<p>When RoT service completes the request from NSPE, TF-M returns the success or
failure error code to NS application.</p>
<p>In single Armv8-M core scenario, TF-M writes the return code value in the
general purpose register and returns to Non-secure state.</p>
<p>On dual-cpu platforms, TF-M writes the return code to NSPE mailbox message queue
via mailbox.</p>
<table class="colwidths-given docutils align-default" id="id38">
<caption><span class="caption-number">Table 19: </span><span class="caption-text">TFM-GENERIC-RETURN-CODE-I-1</span><a class="headerlink" href="#id38" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-RETURN-CODE-I-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>SPE may leave secure data in the registers not banked
after the SPE completes PSA Client calls and executes
<code class="docutils literal notranslate"><span class="pre">BXNS</span></code> to switch Armv8-M back to Non-secure state.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>If SPE doesn’t clean up the secure data in registers not
banked before switching into NSPE in Armv8-M core, NSPE
can read the SPE context from those registers.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Information disclosure</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>In single Armv8-M core scenario, TF-M cleans general
purpose registers not banked before switching into NSPE to
prevent NSPE probing secure context from the registers.</p>
<p>When FPU is enabled in TF-M, secure FP context belonging to
a secure partition will be saved on this partition’s stack
and cleaned by hardware during context switching. Also TF-M
cleans secure FP context in FP registers before switching
into NSPE to prevent NSPE from probing secure FP context.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>4.3 (Medium)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N</p></td>
</tr>
</tbody>
</table>
</section>
<section id="ns-interrupts-preempts-spe-execution">
<h4>NS interrupts preempts SPE execution<a class="headerlink" href="#ns-interrupts-preempts-spe-execution" title="Permalink to this heading"></a></h4>
<p>This section identifies threats on <code class="docutils literal notranslate"><span class="pre">DF5</span></code> defined in <a class="reference internal" href="#data-flow-diagram">Data Flow Diagram</a>.</p>
<table class="colwidths-given docutils align-default" id="id39">
<caption><span class="caption-number">Table 20: </span><span class="caption-text">TFM-GENERIC-NS-INTERRUPT-I-1</span><a class="headerlink" href="#id39" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-NS-INTERRUPT-I-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Shared registers may contain secure data when NS
interrupts occur.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>The secure data in shared registers should be cleaned up
before NSPE can access shared registers. Otherwise, secure
data leakage may occur.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Information disclosure</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>In single Armv8-M core scenario, Armv8-M architecture
automatically cleans up the registers not banked before
switching to Non-secure state while taking NS interrupts.</p>
<p>When FPU is enabled in TF-M, with setting of FPCCR_S.TS = 1
besides secure FP context in FP caller registers, FP
context in FP callee registers will also be cleaned by
hardware automatically when NS interrupts occur, to prevent
NSPE from probing secure FP context in FP registers. Refer
to Armv8-M Architecture Reference Manual[ARM arm]_ for
details.</p>
<p>On dual-cpu platforms, shared registers are implementation
defined, such as Inter-Processor Communication registers.
Dual-cpu platforms must not store any data which may
disclose secure information in the shared registers.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>4.3 (Medium)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id40">
<caption><span class="caption-number">Table 21: </span><span class="caption-text">TFM-GENERIC-NS-INTERRUPT-D-1</span><a class="headerlink" href="#id40" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-NS-INTERRUPT-D-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>An attacker may trigger spurious NS interrupts frequently
to block SPE execution.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>In single Armv8-M core scenario, an attacker may inject a
malicious NS application or hijack a NS hardware to
frequently trigger spurious NS interrupts to keep
preempting SPE and block SPE to perform normal secure
execution.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Denial of service</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>It is out of scope of TF-M.</p>
<p>Assets protected by TF-M won’t be leaked. TF-M won’t be
directly impacted.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>4.0 (Medium)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L</p></td>
</tr>
</tbody>
</table>
</section>
<section id="secure-interrupts-preempts-nspe-execution">
<h4>Secure interrupts preempts NSPE execution<a class="headerlink" href="#secure-interrupts-preempts-nspe-execution" title="Permalink to this heading"></a></h4>
<p>This section identifies threats on <code class="docutils literal notranslate"><span class="pre">DF6</span></code> defined in <a class="reference internal" href="#data-flow-diagram">Data Flow Diagram</a>.</p>
<table class="colwidths-given docutils align-default" id="id41">
<caption><span class="caption-number">Table 22: </span><span class="caption-text">TFM-GENERIC-S-INTERRUPT-I-1</span><a class="headerlink" href="#id41" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-S-INTERRUPT-I-1</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Shared registers may contain secure data when Armv8-M core
switches back to Non-secure state on Secure interrupt
return.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>Armv8-M architecture doesn’t automatically clean up shared
registers while returning to Non-secure state during
Secure interrupt return.</p>
<p>If SPE leaves critical data in the Armv8-M registers not
banked, NSPE can read secure context from those registers
and secure data leakage may occur.</p>
</td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Information disclosure</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>TF-M saves NPSE context in general purpose register R4~R11
into secure stack during secure interrupt entry.
After secure interrupt handling completes, TF-M unstacks
NSPE context from secure stack to overwrite secure context
in R4~R11 before secure interrupt return.</p>
<p>Armv8-M architecture will automatically unstack NSPE
context from non-secure stack to overwrite other registers
not banked, such as R0~R3 and R12, during secure interrupt
return, before NSPE software can access those registers.</p>
<p>When FPU is enabled in TF-M, with setting of
FPCCR_S.TS = 1 and FPCCR_S.CLRONRET = 1, besides secure FP
context in FP caller registers, FP context in callee
registers will also be cleaned by hardware automatically
during S exception return, to prevent NSPE from probing
secure FP context in FP registers. Refer to Armv8-M
Architecture Reference Manual [ARM arm]_ for details.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>4.3 (Medium)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N</p></td>
</tr>
</tbody>
</table>
</section>
<section id="miscellaneous-threats">
<h4>Miscellaneous threats<a class="headerlink" href="#miscellaneous-threats" title="Permalink to this heading"></a></h4>
<p>This section collects threats irrelevant to the valid TF-M data flows shown
above.</p>
<table class="colwidths-given docutils align-default" id="id42">
<caption><span class="caption-number">Table 23: </span><span class="caption-text">TFM-GENERIC-STACK-SEAL</span><a class="headerlink" href="#id42" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-STACK_SEAL</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Armv8-M processor Secure software Stack Sealing
vulnerability.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>On Armv8-M based processors with TrustZone, if Secure
software does not properly manage the Secure stacks when
the stacks are created, or when performing non-standard
transitioning between states or modes, for example,
creating a fake exception return stack frame to
de-privilege an interrupt, it is possible for Non-secure
world software to manipulate the Secure Stacks, and
potentially influence Secure control flow.</p>
<p>Refer to <a class="reference internal" href="#stack-seal" id="id16"><span>[STACK-SEAL]</span></a> for details.</p>
</td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Elevation of privilege</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>TF-M has implemented common mitigation against stack seal
vulnerability.</p>
<p>Refer to <a class="reference internal" href="#advisory-tfmv-1" id="id17"><span>[ADVISORY-TFMV-1]</span></a> for details on analysis and
mitigation in TF-M.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>5.3 (Medium)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:L</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id43">
<caption><span class="caption-number">Table 24: </span><span class="caption-text">TFM-GENERIC-SVC-CALL-SP-FETCH</span><a class="headerlink" href="#id43" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-SVC-CALL-SP-FETCH</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Invoking Secure functions from handler mode may cause TF-M
IPC model to behave unexpectedly.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>On Armv8-M based processors with TrustZone, if NSPE calls
a secure function via Secure Gateway (SG) from non-secure
Handler mode , TF-M selects secure process stack by
mistake for SVC handling.
It will most likely trigger a crash in secure world or
reset the whole system, with a very low likelihood of
overwriting some memory contents.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Denial of service/Tampering</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>TF-M has enhanced implementation to mitigate this
vulnerability.</p>
<p>Refer to <a class="reference internal" href="#advisory-tfmv-2" id="id18"><span>[ADVISORY-TFMV-2]</span></a> for details on analysis and
mitigation in TF-M.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>4.5 (Medium)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:H/PR:N/UI:N/S:C/C:N/I:L/A:L</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id44">
<caption><span class="caption-number">Table 25: </span><span class="caption-text">VLLDM instruction security vulnerability</span><a class="headerlink" href="#id44" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 83%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Index</p></td>
<td><p><strong>TFM-GENERIC-FP-VLLDM</strong></p></td>
</tr>
<tr class="row-even"><td><p>Description</p></td>
<td><p>Secure data in FP registers may be disclosed to NSPE when
VLLDM instruction is abandoned due to an exception mid-way.</p></td>
</tr>
<tr class="row-odd"><td><p>Justification</p></td>
<td><p>Refer to [VLLDM Vulnerability]_ for details.</p></td>
</tr>
<tr class="row-even"><td><p>Category</p></td>
<td><p>Tampering/Information disclosure</p></td>
</tr>
<tr class="row-odd"><td><p>Mitigation</p></td>
<td><p>In current TF-M implementation, when FPU is enabled in SPE,
TF-M configures NSACR to disable NSPE to access FPU.
Therefore, secure data in FP registers is protected from
NSPE.</p>
<p>Refer to [VLLDM Vulnerability]_, for details on analysis
and mitigation.</p>
</td>
</tr>
<tr class="row-even"><td><p>CVSS Score</p></td>
<td><p>3.4 (Low)</p></td>
</tr>
<tr class="row-odd"><td><p>CVSS Vector
String</p></td>
<td><p>CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="version-control">
<h2>Version control<a class="headerlink" href="#version-control" title="Permalink to this heading"></a></h2>
<table class="docutils align-default" id="id45">
<caption><span class="caption-number">Table 26: </span><span class="caption-text">Version control</span><a class="headerlink" href="#id45" title="Permalink to this table"></a></caption>
<colgroup>
<col style="width: 12%" />
<col style="width: 68%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Version</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>TF-M version</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>v0.1</p></td>
<td><p>Initial draft</p></td>
<td><p>TF-M v1.1</p></td>
</tr>
<tr class="row-odd"><td><p>v1.0</p></td>
<td><p>First version</p></td>
<td><p>TF-M v1.2.0</p></td>
</tr>
<tr class="row-even"><td><p>v1.1</p></td>
<td><p>Update version</p></td>
<td><p>TF-M v1.5.0</p></td>
</tr>
<tr class="row-odd"><td><p>v1.2</p></td>
<td><p>Update details to align FP support in NSPE.</p></td>
<td><p>TF-M v1.5.0</p></td>
</tr>
</tbody>
</table>
</section>
<section id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this heading"></a></h2>
<dl class="citation">
<dt class="label" id="security-incident-process"><span class="brackets"><a class="fn-backref" href="#id1">Security-Incident-Process</a></span></dt>
<dd><p><a class="reference external" href="https://developer.trustedfirmware.org/w/collaboration/security_center/reporting/">Security Incident Process</a></p>
</dd>
<dt class="label" id="ff-m"><span class="brackets">FF-M</span><span class="fn-backref">(<a href="#id2">1</a>,<a href="#id3">2</a>,<a href="#id4">3</a>,<a href="#id13">4</a>,<a href="#id14">5</a>,<a href="#id15">6</a>)</span></dt>
<dd><p><a class="reference external" href="https://developer.arm.com/-/media/Files/pdf/PlatformSecurityArchitecture/Architect/DEN0063-PSA_Firmware_Framework-1.0.0-2.pdf?revision=2d1429fa-4b5b-461a-a60e-4ef3d8f7f4b4">Arm® Platform Security Architecture Firmware Framework 1.0</a></p>
</dd>
</dl>
<dl class="citation">
<dt class="label" id="dual-cpu-boot"><span class="brackets"><a class="fn-backref" href="#id12">DUAL-CPU-BOOT</a></span></dt>
<dd><p><a class="reference internal" href="../../technical_references/design_docs/dual-cpu/booting_a_dual_core_system.html"><span class="doc">Booting a dual core system</span></a></p>
</dd>
<dt class="label" id="cvss"><span class="brackets"><a class="fn-backref" href="#id5">CVSS</a></span></dt>
<dd><p><a class="reference external" href="https://www.first.org/cvss/calculator/3.1">Common Vulnerability Scoring System Version 3.1 Calculator</a></p>
</dd>
<dt class="label" id="cvss-spec"><span class="brackets">CVSS_SPEC</span><span class="fn-backref">(<a href="#id6">1</a>,<a href="#id7">2</a>,<a href="#id9">3</a>)</span></dt>
<dd><p><a class="reference external" href="https://www.first.org/cvss/v3-1/cvss-v31-specification_r1.pdf">CVSS v3.1 Specification Document</a></p>
</dd>
<dt class="label" id="stride"><span class="brackets"><a class="fn-backref" href="#id8">STRIDE</a></span></dt>
<dd><p><a class="reference external" href="https://docs.microsoft.com/en-us/previous-versions/commerce-server/ee823878(v=cs.20)?redirectedfrom=MSDN">The STRIDE Threat Model</a></p>
</dd>
<dt class="label" id="secure-boot"><span class="brackets"><a class="fn-backref" href="#id10">SECURE-BOOT</a></span></dt>
<dd><p><a class="reference internal" href="../../technical_references/design_docs/tfm_secure_boot.html"><span class="doc">Secure boot</span></a></p>
</dd>
<dt class="label" id="rollback-protect"><span class="brackets"><a class="fn-backref" href="#id11">ROLLBACK-PROTECT</a></span></dt>
<dd><p><a class="reference internal" href="../../technical_references/design_docs/secure_boot_rollback_protection.html"><span class="doc">Rollback protection in TF-M secure boot</span></a></p>
</dd>
</dl>
<dl class="citation">
<dt class="label" id="stack-seal"><span class="brackets"><a class="fn-backref" href="#id16">STACK-SEAL</a></span></dt>
<dd><p><a class="reference external" href="https://developer.arm.com/support/arm-security-updates/armv8-m-stack-sealing">Armv8-M processor Secure software Stack Sealing vulnerability</a></p>
</dd>
<dt class="label" id="advisory-tfmv-1"><span class="brackets"><a class="fn-backref" href="#id17">ADVISORY-TFMV-1</a></span></dt>
<dd><p><a class="reference internal" href="../security_advisories/stack_seal_vulnerability.html"><span class="doc">Advisory TFMV-1</span></a></p>
</dd>
<dt class="label" id="advisory-tfmv-2"><span class="brackets"><a class="fn-backref" href="#id18">ADVISORY-TFMV-2</a></span></dt>
<dd><p><a class="reference internal" href="../security_advisories/svc_caller_sp_fetching_vulnerability.html"><span class="doc">Advisory TFMV-2</span></a></p>
</dd>
</dl>
<hr class="docutils" />
<p><em>Copyright (c) 2020-2022 Arm Limited. All Rights Reserved.</em></p>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>