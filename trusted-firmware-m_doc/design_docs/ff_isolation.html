<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FF-M Isolation &mdash; Trusted Firmware-M v2.1.0-stm32mp-r1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/tfm_custom.css" type="text/css" />
      <link rel="stylesheet" href="../_static/tabs.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="TF-M builtin keys" href="tfm_builtin_keys.html" />
    <link rel="prev" title="Fixing implicit casting for C enumeration values" href="software/enum_implicit_casting.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Trusted Firmware-M
              <img src="../_static/tf_logo_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v2.1.0-stm32mp-r1

              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">Introduction</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/index.html">Getting Started</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../security/threat_models/generic_threat_model.html">Threat model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../security/security_advisories/index.html">Security Advisories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/stack_seal_vulnerability.html">Advisory TFMV-1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/svc_caller_sp_fetching_vulnerability.html">Advisory TFMV-2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/crypto_multi_part_ops_abort_fail.html">Advisory TFMV-3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/profile_small_key_id_encoding_vulnerability.html">Advisory TFMV-4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/fwu_write_vulnerability.html">Advisory TFMV-5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/cc3xx_partial_tag_compare_on_chacha20_poly1305.html">Advisory TFMV-6</a></li>
<li class="toctree-l3"><a class="reference internal" href="../security/security_advisories/debug_log_vulnerability.html">Advisory TFMV-7</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../releases/index.html">Releases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../releases/2.1.0.html">v2.1.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/2.0.0.html">v2.0.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/1.8.1.html">v1.8.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/1.8.0.html">v1.8.0</a></li>
<li class="toctree-l2"><a class="reference internal" href="../releases/release_process.html">Release Cadence and Process</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../roadmap.html">Roadmap</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../platform/index.html">Platforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../platform/arm/index.html">Arm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/corstone1000/readme.html">Corstone-1000</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/mps3/corstone300/README.html">Corstone-300 FPGA (AN547 and AN552) and FVP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/mps3/corstone310/README.html">Corstone-310 FPGA (AN555) and FVP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/mps4/corstone315/README.html">Corstone-315 FVP</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/musca_b1/readme.html">Musca-B1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/musca_s1/readme.html">Musca-S1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/arm/rse/index.html">Runtime Security Engine</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/armchina/index.html">ArmChina</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/armchina/mps3/alcor/README.html">Alcor FPGA (AN557)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/cypress/index.html">Cypress</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/cypress/psoc64/index.html">PSoC64</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/lairdconnectivity/index.html">Laird Connectivity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/lairdconnectivity/bl5340_dvk_cpuapp/README.html">BL5340</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/nordic_nrf/index.html">Nordic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/nordic_nrf/nrf5340dk_nrf5340_cpuapp/README.html">nRF5340</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/nordic_nrf/nrf9160dk_nrf9160/README.html">nRF9160</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/nordic_nrf/nrf9161dk_nrf9161/README.html">nRF9161</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/nuvoton/index.html">Nuvoton</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/nuvoton/m2351/README.html">NuMaker-PFM-M2351</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/nuvoton/m2354/README.html">NuMaker-PFM-M2354</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/nxp/index.html">NXP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/nxp/lpcxpresso55s69/README.html">LPCXpresso55S69</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../platform/stm/index.html">STMICROELECTRONICS</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32h5xx/readme.html">STM32H5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32l5xx/readme.html">STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32mp2xx/readme.html">STM32MP2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32u5xx/readme.html">STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO_L552ZE_Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32h573i_dk/readme.html">STM32H573I_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32l562e_dk/readme.html">STM32L562E_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp215f_dk/readme.html">stm32mp215f_dk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/b_u585i_iot02a/readme.html">B_U585I_IOT02A</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../building/tfm_build_instruction.html">Build instructions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../building/tests_build_instruction.html">Build Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../building/run_tfm_examples_on_arm_platforms.html">Run TF-M tests and applications</a></li>
<li class="toctree-l2"><a class="reference internal" href="../building/documentation_generation.html">Building the documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../building/tfm_build_instruction_iar.html">IAR toolchain</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration/index.html">Configuration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../configuration/build_configuration.html">Build configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/header_file_system.html">Component configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/kconfig_system.html">Kconfig</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/profiles/index.html">Profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_small.html"> Small</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_medium_arot-less.html"> ARoT-less</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_medium.html"> Medium</a></li>
<li class="toctree-l3"><a class="reference internal" href="../configuration/profiles/tfm_profile_large.html"> Large</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/test_configuration.html">Tests configuration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../integration_guide/index.html">Integration Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/source_structure/source_structure.html">Source Structure</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/source_structure/platform_folder.html">Details for the /platform folder</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/source_structure/platform_ext_folder.html">Details for the /platform/ext folder</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/spm_backends.html">SPM Backends</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/non-secure_client_extension_integration_guide.html">NS client integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/os_migration_guide_armv8m.html">OS migration to Armv8-M</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/tfm_fpu_support.html">Floating-Point Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/tfm_secure_irq_integration_guide.html">Secure Interrupt</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/platform_provisioning.html">Platform Provisioning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/platform/index.html">Adding a new platform</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/platform/porting_tfm_to_a_new_hardware.html">Porting TF-M to a New Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/platform/documenting_platform.html">Platform Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/platform/platform_deprecation.html">Platform deprecation and removal</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../integration_guide/services/index.html">Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_attestation_integration_guide.html">Initial Attestation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_crypto_integration_guide.html">Crypto</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_its_integration_guide.html">Internal Trusted Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_platform_integration_guide.html">Platform</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_ps_integration_guide.html">Protected Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_secure_partition_addition.html">Adding a New Secure Partition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_manifest_tool_user_guide.html">Manifest Tool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../integration_guide/services/tfm_adac_integration_guide.html">ADAC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Design Documents</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="booting/tfm_secure_boot.html">Secure Boot</a><ul>
<li class="toctree-l3"><a class="reference internal" href="booting/bl1.html">BL1 Immutable bootloader</a></li>
<li class="toctree-l3"><a class="reference internal" href="booting/secure_boot_rollback_protection.html">Rollback Protection</a></li>
<li class="toctree-l3"><a class="reference internal" href="booting/secure_boot_hw_key_integration.html">HW Key integration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="dual-cpu/index.html">Dual CPU</a><ul>
<li class="toctree-l3"><a class="reference internal" href="dual-cpu/booting_a_dual_core_system.html">Booting</a></li>
<li class="toctree-l3"><a class="reference internal" href="dual-cpu/communication_prototype_between_nspe_and_spe_in_dual_core_systems.html">SPE - NSPE communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="dual-cpu/mailbox_design_on_dual_core_system.html">Mailbox</a></li>
<li class="toctree-l3"><a class="reference internal" href="dual-cpu/mailbox_ns_agent_update.html">Mailbox update</a></li>
<li class="toctree-l3"><a class="reference internal" href="dual-cpu/tfm_multi_core_access_check.html">Memory Access Check</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="services/index.html">Secure Services</a><ul>
<li class="toctree-l3"><a class="reference internal" href="services/secure_partition_manager.html">Secure Partition Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/secure_partition_runtime_library.html">Secure Partition RTL</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_psa_inter_process_communication.html">Inter-Process Communication</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/stateless_rot_service.html">Stateless Services</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_uniform_secure_service_signature.html">Service Signing</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_crypto_design.html">Crypto</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/symmetric_initial_attest.html">Initial Attestation</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_its_service.html">Internal Trusted Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/tfm_fwu_service.html">Firmware Update</a></li>
<li class="toctree-l3"><a class="reference internal" href="services/ps_key_management.html">PS Key Management</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="software/index.html">Software Design</a><ul>
<li class="toctree-l3"><a class="reference internal" href="software/code_sharing.html">Code Sharing</a></li>
<li class="toctree-l3"><a class="reference internal" href="software/hardware_abstraction_layer.html">Hardware Abstraction Layer</a></li>
<li class="toctree-l3"><a class="reference internal" href="software/tfm_cooperative_scheduling_rules.html">Cooperative Scheduling</a></li>
<li class="toctree-l3"><a class="reference internal" href="software/tfm_code_generation_with_jinja2.html">Code Templates</a></li>
<li class="toctree-l3"><a class="reference internal" href="software/enum_implicit_casting.html">Implicit Typecasting</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Isolation Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="tfm_builtin_keys.html">Builtin Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="tfm_log_system_design_document.html">Logging system</a></li>
<li class="toctree-l2"><a class="reference internal" href="tfm_physical_attack_mitigation.html">Physical Attack Mitigation</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contribution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Guidelines</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contributing/contributing_process.html">The process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/code_review_guide.html">Code review</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/maintainers.html">Maintainers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/maintainers.html#code-owners">Code owners</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/coding_guide.html">Yet another coding standard :)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/doc_guidelines.html">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/tfm_design_proposal_guideline.html">Design proposal</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/lic.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/dco.html">DCO</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://trustedfirmware-m.readthedocs.io/projects/tf-m-tests/en/latest/">TF-M Tests</a></li>
<li class="toctree-l1"><a class="reference external" href="https://trustedfirmware-m.readthedocs.io/projects/tf-m-tools/en/latest/">TF-M Tools</a></li>
<li class="toctree-l1"><a class="reference external" href="https://trustedfirmware-m.readthedocs.io/projects/tf-m-extras/en/latest/">TF-M Extras</a></li>
<li class="toctree-l1"><a class="reference external" href="https://ci.trustedfirmware.org/job/tf-m-build-docs-nightly/lastSuccessfulBuild/artifact/trusted-firmware-m/build/docs/reference_manual/html/index.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference external" href="https://developer.trustedfirmware.org/w/collaboration/security_center">Security Center</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.arm.com/architecture/security-features/platform-security">PSA</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">STMICROELECTRONICS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../stm/releases/index.html">Releases</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stm/releases/getting_started.html">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32h573i_dk/readme.html">STM32H573I_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32l562e_dk/readme.html">STM32L562E_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp215f_dk/readme.html">stm32mp215f_dk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO_L552ZE_Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/b_u585i_iot02a/readme.html">B_U585I_IOT02A</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/releases/platforms.html">Platforms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32h5xx/readme.html">STM32H5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32l5xx/readme.html">STM32L5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32mp2xx/readme.html">STM32MP2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/common/stm32u5xx/readme.html">STM32U5</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/nucleo_l552ze_q/readme.html">NUCLEO_L552ZE_Q</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32h573i_dk/readme.html">STM32H573I_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32l562e_dk/readme.html">STM32L562E_DK</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp215f_dk/readme.html">stm32mp215f_dk</a></li>
<li class="toctree-l3"><a class="reference internal" href="../platform/stm/stm32mp257f_ev1/readme.html">stm32mp257f_ev1</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/releases/changelog.html">Change Log &amp; Notes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/releases/v1.7.0/index.html">v1.7.0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/releases/v2.1.0/index.html">v2.1.0</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stm/releases/index.html#branch-plans">Branch plans</a></li>
<li class="toctree-l1"><a class="reference internal" href="../stm/technical/index.html">Technical references</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/a35_td_flavor/index.html">A35-TD flavor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/a35_td_flavor/memory_layout.html">Memory layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/a35_td_flavor/storage.html">Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/m33_td_flavor/index.html">M33-TD flavor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/m33_td_flavor/memory_layout.html">Memory layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/m33_td_flavor/storage.html">Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/devicetree/index.html">Devicetree</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/devicetree/devicetree_tfm.html">Scope and purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/devicetree/devicetree_tfm.html#concept">Concept</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stm/technical/devicetree/devicetree_tfm.html#how-to-add-device">How to add device</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/initlevel.html">Initlevel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/initial_attestation.html">Initial Attestation Service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stm/technical/nv_counter.html">Nv counter</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stm/ide/index.html">Ide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stm/ide/cube/stm32cubeide.html">STM32CubeIDE</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Trusted Firmware-M</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Design Documents</a></li>
      <li class="breadcrumb-item active">FF-M Isolation</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="ff-m-isolation">
<h1>FF-M Isolation<a class="headerlink" href="#ff-m-isolation" title="Permalink to this heading"></a></h1>
<dl class="field-list simple">
<dt class="field-odd">Organization</dt>
<dd class="field-odd"><p>Arm Limited</p>
</dd>
<dt class="field-even">Contact</dt>
<dd class="field-even"><p><a class="reference external" href="mailto:tf-m&#37;&#52;&#48;lists&#46;trustedfirmware&#46;org">tf-m<span>&#64;</span>lists<span>&#46;</span>trustedfirmware<span>&#46;</span>org</a></p>
</dd>
</dl>
<p>This document analyzes the isolation rules of implementing <code class="docutils literal notranslate"><span class="pre">FF-M</span> <span class="pre">1.0</span></code>
isolation and introduces the reference implementation in TF-M, which
complies the rules by operating the hardware and software resources.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Reference the document <a class="reference internal" href="../glossary.html"><span class="doc">Glossary</span></a> for terms
and abbreviations.</p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<p>This chapter describes the definitions from <code class="docutils literal notranslate"><span class="pre">FF-M</span></code> and analyzes
the possible implementation keypoints.</p>
<div class="section" id="isolation-levels">
<h3>Isolation Levels<a class="headerlink" href="#isolation-levels" title="Permalink to this heading"></a></h3>
<p>There are 3 isolation levels (1-3) defined in <code class="docutils literal notranslate"><span class="pre">FF-M</span></code>, the greater level
number has more isolation boundaries.</p>
<p>The definition for Isolation Level 1:</p>
<ul class="simple">
<li><p>L1.1 NPSE needs protection from nobody.</p></li>
<li><p>L1.2 SPE needs protection from NSPE.</p></li>
</ul>
<p>The definition for Isolation Level 2:</p>
<ul class="simple">
<li><p>L2.1 NPSE needs protection from nobody.</p></li>
<li><p>L2.2 Application Root of Trust (ARoT) needs protection from NSPE.</p></li>
<li><p>L2.3 PSA Root of Trust (PRoT) needs protection from NSPE and ARoT.</p></li>
</ul>
<p>The definition for Isolation Level 3:</p>
<ul class="simple">
<li><p>L3.1 NPSE needs protection from nobody.</p></li>
<li><p>L3.2 Secure Partition needs protection from NSPE and other Secure Partitions.</p></li>
<li><p>L3.3 PSA Root of Trust (RoT) domain needs protection from NSPE and all Secure
Partitions.</p></li>
</ul>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>A Secure Partition RoT Service is a Root of Trust Service implemented within
a Secure Partition. An Application RoT Service must be implemented as
a Secure Partition RoT Service. But it is implementation-defined whether a
PSA RoT Service is a Secure Partition RoT Service.</p>
<p>Here listed several possible PSA RoT Service implementation mechanisms:</p>
<ol class="arabic simple">
<li><p>Implement PSA RoT Services in Secure Partitions with respective
boundaries.</p></li>
<li><p>Implement PSA RoT Services in Secure Partitions, but no boundaries between
these Secure Partitions as they are in the PSA RoT Domain.</p></li>
<li><p>Implement PSA RoT Services in a customized way instead of Secure
Partitions, an internal library of PSA RoT domain e.g.</p></li>
</ol>
<p>TF-M chooses the 2nd option to balance performance and complexity.</p>
</div>
</div>
<div class="section" id="isolation-rules">
<h3>Isolation Rules<a class="headerlink" href="#isolation-rules" title="Permalink to this heading"></a></h3>
<p>The essence of isolation is to protect the assets of one protection domain from
being accessed from other domains. The isolation levels define where the
isolation boundaries should be placed, the isolation rules define the strength
of the isolation the boundaries should offer.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to chapter <cite>Memory Assets</cite> in <a class="reference external" href="https://www.arm.com/architecture/security-features/platform-security">Firmware Framework for M (FF-M)</a> to
know asset class items. Assets are represented by memory addresses in the
system memory map, which makes assets named <cite>Memory Assets</cite>. The often-seen
asset items are ROM, RAM, and memory-mapped peripherals.</p>
</div>
<div class="section" id="memory-asset-class">
<h4>Memory Asset Class<a class="headerlink" href="#memory-asset-class" title="Permalink to this heading"></a></h4>
<p>There are 3 memory asset classes defined in <a class="reference external" href="https://www.arm.com/architecture/security-features/platform-security">Firmware Framework for M (FF-M)</a>:</p>
<ul class="simple">
<li><p>Code</p></li>
<li><p>Constant data</p></li>
<li><p>Private data</p></li>
</ul>
<p>There are 6 isolation rules for protecting assets. Here lists the simplified
description for the rules, check chapter <code class="docutils literal notranslate"><span class="pre">3.1.2</span></code> of <code class="docutils literal notranslate"><span class="pre">FF-M</span> <span class="pre">1.0</span></code> for the
original description:</p>
<ul class="simple">
<li><p>I1. Only Code is executable.</p></li>
<li><p>I2. Only private data is writable.</p></li>
<li><p>I3. If domain A needs protection from domain B, then Private data in domain A
cannot be accessed by domain B.</p></li>
<li><p>I4. (Optional) If domain A needs protection from domain B, then Code and
Constant data in domain A is not readable or executable by domain B.</p></li>
<li><p>I5. (Optional) Code in a domain is not executable by any other domain.</p></li>
<li><p>I6. (Optional) All assets in a domain are private to that domain and cannot be
accessed by any other domain, with the following exception:
The domain containing the SPM can only access Private data and Constant data
assets of other domains when required to implement the PSA Firmware Framework
API.</p></li>
<li><p>I7. (Optional, added in FF-M 1.1) Constant data is not executable.</p></li>
</ul>
<blockquote>
<div><p>The first 3 rules from <code class="docutils literal notranslate"><span class="pre">I1</span></code> to <code class="docutils literal notranslate"><span class="pre">I3</span></code> defines the mandatory rules to comply
the isolation, while <code class="docutils literal notranslate"><span class="pre">I4</span></code> to <code class="docutils literal notranslate"><span class="pre">I6</span></code> are optional rules to enhance the
isolation boundaries.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>There is a table in the chapter <code class="docutils literal notranslate"><span class="pre">3.1.2</span></code> of <code class="docutils literal notranslate"><span class="pre">FF-M</span> <span class="pre">1.0</span></code> under <code class="docutils literal notranslate"><span class="pre">I1</span></code> lists
the asset types and allowed access method. Preventing executable access on
constant data costs more hardware resources, so there is an optional rule
I7 created in <a class="reference external" href="https://developer.arm.com/documentation/aes0039/latest">FF-M Extensions (FF-M 1.1)</a> to comfort implementations with
constrained hardware resources.</p>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="hardware-infrastructure">
<h3>Hardware Infrastructure<a class="headerlink" href="#hardware-infrastructure" title="Permalink to this heading"></a></h3>
<p>To implement a secure system, the hardware security framework (TrustZone or
multiple-core e.g.) and their auxiliary components (SAU e.g.) are required
to ensure the isolation between SPE and NSPE. The requirements:</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The interface between secure and non-secure states needs to be fully
enumerated and audited to prove the integrity of the secure state
isolation.</p>
</div>
<p>Besides this SPE and NSPE isolation mechanism, the following analyzes the
implementation rules to find out the hardware requirements for isolation inside
SPE domains:</p>
<ul class="simple">
<li><p>I1 and I2: The assets can be categorized into 3 <a class="reference internal" href="#memory-asset-class">Memory Asset Class</a>, each
type has the specific access rules.</p></li>
<li><p>I3: The private data access from the prevented domain needs to be blocked.</p></li>
<li><p>I4: All the assets access from the prevented domain needs to be blocked.</p></li>
<li><p>I5: Code execution from all other domains (even the domain not prevented
from) needs to be blocked.</p></li>
<li><p>I6: All the assets access from all other domains (includes non-prevented
domain) needs to be blocked, but, SPM is an exception, which can access the
private data and constant data of the current domain.</p></li>
</ul>
<p>The above items list the requirements for memory access, here are two more
points:</p>
<ul class="simple">
<li><p>If the memory device or the peripheral are shared between multiple hosts
(Such as multiple CPU or DMA, etc), specific hardware protection units need
to be available for validating accesses to that device or peripheral.</p></li>
<li><p>The MMIO range for Secure Partitions is not allowed to be overlapped, which
means each partition should have exclusive memory-mapped region if they
require a peripheral device. The memory-mapped region is regarded as
the private data so access to this area needs to be validated.</p></li>
</ul>
</div>
</div>
<div class="section" id="reference-implementation">
<h2>Reference Implementation<a class="headerlink" href="#reference-implementation" title="Permalink to this heading"></a></h2>
<p>This chapter describes the isolation implementation inside SPE by using the
Armv8m architecture component - Memory Protection Unit (MPU). The MPU can
isolate CPU execution and data access.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Previous version M-profile architecture MPU setting is similar in concept but
the difference in practical register formats, which is not described in this
document.</p>
</div>
<p>The MPU protects memory assets by regions. Each region represents a memory
range with specific access attributes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The maximum numbers of MPU regions are platform-specific.</p>
</div>
<p>The SPM is running under the privileged mode for handling access from services.
The MPU region for SPM needs to be available all the time since SPM controls
the MPU setting while scheduling.</p>
<p>Since partitions are scheduled by SPM, the MPU regions corresponding to the
partitions can be configured dynamically while scheduling. Since there is only
one running at a time and all others are deactivated, the SPM needs to set up
necessary regions for each asset type in one partition only.</p>
<p>There is re-usable code like the C-Runtime and RoT Service API which are same
across different partitions. TF-M creates a Secure Partition Runtime Library
(SPRTL) as a specific library shared by the Secure Partition. Please refer to
<a class="reference internal" href="services/secure_partition_runtime_library.html"><span class="doc">Secure Partition Runtime Library</span></a>
for more detail.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Enable SPRTL makes it hard to comply with the rules I4, I5 and I6,
duplicating the library code can be one solution but it is not “shared”
library anymore.</p>
</div>
<p>As mentioned in the last chapter, MMIO needs extra MPU regions as private data.</p>
<div class="section" id="mpu-region-access-permission">
<h3>MPU Region Access Permission<a class="headerlink" href="#mpu-region-access-permission" title="Permalink to this heading"></a></h3>
<p>The following content would mention the memory access permission to represent
the corresponded asset classes.</p>
<p>These access permissions are available on Armv8m MPU:</p>
<ul class="simple">
<li><p>Privileged Read-Only (RO)</p></li>
<li><p>All RO</p></li>
<li><p>Privileged Read-Write (RW)</p></li>
<li><p>All RW</p></li>
<li><p>Execution Never (XN)</p></li>
</ul>
<p>And one more Armv8.1M access permssion:</p>
<ul class="simple">
<li><p>Privileged Execution Never (PXN)</p></li>
</ul>
<p>The available regions type list:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 11%" />
<col style="width: 15%" />
<col style="width: 20%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Attributes</p></th>
<th class="head"><p>Privilege Level</p></th>
<th class="head"><p>Asset</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>P_RO</p></td>
<td><p>RO</p></td>
<td><p>Privileged</p></td>
<td><p>PRoT Code</p></td>
</tr>
<tr class="row-odd"><td><p>P_ROXN</p></td>
<td><p>RO + XN</p></td>
<td><p>Privileged</p></td>
<td><p>PRoT Constant Data</p></td>
</tr>
<tr class="row-even"><td><p>P_RWXN</p></td>
<td><p>RW + XN</p></td>
<td><p>Privileged</p></td>
<td><p>PRoT Private Data/Peripheral</p></td>
</tr>
<tr class="row-odd"><td><p>A_RO</p></td>
<td><p>RO</p></td>
<td><p>Any privilege</p></td>
<td><p>Partition/SPRTL Code</p></td>
</tr>
<tr class="row-even"><td><p>A_ROXN</p></td>
<td><p>RO + XN</p></td>
<td><p>Any privilege</p></td>
<td><p>Partition/SPRTL Constant Data</p></td>
</tr>
<tr class="row-odd"><td><p>A_RWXN</p></td>
<td><p>RW + XN</p></td>
<td><p>Any privilege</p></td>
<td><p>Partition/SPRTL Private Data/Peripheral</p></td>
</tr>
<tr class="row-even"><td><p>A_ROPXN</p></td>
<td><p>RO + PXN</p></td>
<td><p>Any privilege</p></td>
<td><p>Armv8.1M Partition/SPRTL Code</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="example-image-layout">
<h3>Example Image Layout<a class="headerlink" href="#example-image-layout" title="Permalink to this heading"></a></h3>
<p>The secure firmware image contains components such as partitions, SPM and the
shared code and data. Each component may have different class assets. There
would be advantages if placing the assets from all components with the same
access attributes into one same region:</p>
<ul class="simple">
<li><p>The data relocating or clearing when booting can be done in one step instead
of breaking into fragments.</p></li>
<li><p>Assets with statically assigned access attribute can share the same MPU
region which saves regions.</p></li>
</ul>
<p>Take the TF-M existing implementation image layout as an example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span> <span class="n">Level</span> <span class="mi">1</span>      <span class="n">Level</span> <span class="mi">2</span>             <span class="n">Level</span> <span class="mi">3</span>
 <span class="n">Boundaries</span>   <span class="n">Boundaries</span>          <span class="n">Boundaries</span>
<span class="o">+------------+----------+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span>          <span class="o">|</span>    <span class="n">PRoT</span> <span class="n">SPM</span>                <span class="n">Code</span>    <span class="o">|</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">PRoT</span>     <span class="o">+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">Code</span>     <span class="o">|</span>    <span class="n">PRoT</span> <span class="n">Service</span>            <span class="n">Code</span>    <span class="o">|</span>
<span class="o">|</span>  <span class="n">Code</span>      <span class="o">+----------+------------------------------------+</span>
<span class="o">|</span>  <span class="p">(</span><span class="n">ROM</span><span class="p">)</span>     <span class="o">|</span>          <span class="o">|</span>    <span class="n">Partition</span> <span class="mi">1</span>             <span class="n">Code</span>    <span class="o">|</span>
<span class="o">|</span>            <span class="o">|</span>          <span class="o">+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">ARoT</span>     <span class="o">|</span>    <span class="n">Partition</span> <span class="n">N</span>             <span class="n">Code</span>    <span class="o">|</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">Code</span>     <span class="o">+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span>          <span class="o">|</span>    <span class="n">SPRTL</span>                   <span class="n">Code</span>    <span class="o">|</span>
<span class="o">+------------+----------+------------------------------------+</span>
<span class="n">Check</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">more</span> <span class="n">details</span> <span class="n">between</span> <span class="n">Code</span> <span class="ow">and</span> <span class="n">Constant</span> <span class="n">Data</span><span class="o">.</span>
<span class="o">+------------+----------+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">PRoT</span>     <span class="o">|</span>    <span class="n">PRoT</span> <span class="n">SPM</span>       <span class="n">Constant</span> <span class="n">Data</span>    <span class="o">|</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">Constant</span> <span class="o">+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">Data</span>     <span class="o">|</span>    <span class="n">PRoT</span> <span class="n">Service</span>   <span class="n">Constant</span> <span class="n">Data</span>    <span class="o">|</span>
<span class="o">|</span>  <span class="n">Constant</span>  <span class="o">+----------+------------------------------------+</span>
<span class="o">|</span>   <span class="n">Data</span>     <span class="o">|</span> <span class="n">ARoT</span>     <span class="o">|</span>    <span class="n">Partition</span> <span class="mi">1</span>    <span class="n">Constant</span> <span class="n">Data</span>    <span class="o">|</span>
<span class="o">|</span>   <span class="p">(</span><span class="n">ROM</span><span class="p">)</span>    <span class="o">|</span> <span class="n">Constant</span> <span class="o">+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">Data</span>     <span class="o">|</span>    <span class="n">Partition</span> <span class="n">N</span>    <span class="n">Constant</span> <span class="n">Data</span>    <span class="o">|</span>
<span class="o">|</span>            <span class="o">|</span>          <span class="o">+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span>          <span class="o">|</span>    <span class="n">SPRTL</span>          <span class="n">Constant</span> <span class="n">Data</span>    <span class="o">|</span>
<span class="o">+------------+----------+------------------------------------+</span>

<span class="o">+------------+----------+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">PRoT</span>     <span class="o">|</span>    <span class="n">PRoT</span> <span class="n">SPM</span>        <span class="n">Private</span> <span class="n">Data</span>    <span class="o">|</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">Private</span>  <span class="o">+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">Data</span>     <span class="o">|</span>    <span class="n">PRoT</span> <span class="n">Service</span>    <span class="n">Private</span> <span class="n">Data</span>    <span class="o">|</span>
<span class="o">|</span>  <span class="n">Private</span>   <span class="o">+----------+------------------------------------+</span>
<span class="o">|</span>   <span class="n">Data</span>     <span class="o">|</span>          <span class="o">|</span>    <span class="n">Partition</span> <span class="mi">1</span>     <span class="n">Private</span> <span class="n">Data</span>    <span class="o">|</span>
<span class="o">|</span>   <span class="p">(</span><span class="n">RAM</span><span class="p">)</span>    <span class="o">|</span> <span class="n">ARoT</span>     <span class="o">+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">Private</span>  <span class="o">|</span>    <span class="n">Partition</span> <span class="n">N</span>     <span class="n">Private</span> <span class="n">Data</span>    <span class="o">|</span>
<span class="o">|</span>            <span class="o">|</span> <span class="n">Data</span>     <span class="o">+------------------------------------+</span>
<span class="o">|</span>            <span class="o">|</span>          <span class="o">|</span>    <span class="n">SPRTL</span>           <span class="n">Private</span> <span class="n">Data</span>    <span class="o">|</span>
<span class="o">+------------+----------+------------------------------------+</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>Multiple binaries image implementation could also reference this layout if
its hardware protection unit can cover the exact boundaries mentioned
above.</p></li>
<li><p>Private data includes both initialized and non-initialized (ZI) sections.
Check chapter <code class="docutils literal notranslate"><span class="pre">3.1.1</span></code> of <code class="docutils literal notranslate"><span class="pre">FF-M</span></code> for the details.</p></li>
<li><p>This diagram shows the boundaries but not orders. The order of regions
inside one upper region can be adjusted freely.</p></li>
<li><p>As described in the <code class="docutils literal notranslate"><span class="pre">important</span></code> of <a class="reference internal" href="#memory-asset-class">Memory Asset Class</a>, the setting
between Code and Constant Data can be skipped if the executable access
method is not applied to constant data. In this case, the groups of Code
and Constant Data can be combined or even mixed – but the boundary
between PRoT and ARoT are still required under level higher than 1.</p></li>
</ol>
</div>
</div>
<div class="section" id="example-region-numbers-under-isolation-level-3">
<h3>Example Region Numbers under Isolation Level 3<a class="headerlink" href="#example-region-numbers-under-isolation-level-3" title="Permalink to this heading"></a></h3>
<p>The following table lists the required regions while complying the rules for
implementing isolation level 3. The level 1 and level 2 can be exported by
simplifying the items in level 3 table.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The table described below is trying to be shared between all supported
platforms in Trusted Firmware - M. It is obvious that some platforms have
special characteristics. In that case, the specific layout table for a
particular platform can be totally redesigned but need to fulfil the
isolation level requirements.</p>
</div>
<ul class="simple">
<li><p>Care only the running partitions assets since deactivated partition does not
need regions.</p></li>
<li><p><cite>X</cite> indicates the existence of this region can’t comply with the rule.</p></li>
<li><p>An <cite>ATTR + n</cite> represent extra <code class="docutils literal notranslate"><span class="pre">n</span></code> regions are necessary.</p></li>
<li><p>Here assumes the rules with a greater number covers the requirements in the
rules with less number.</p></li>
</ul>
<p>Here lists the required regions while complying with the rules:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 26%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 19%" />
<col style="width: 19%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Region Purpose</p></th>
<th class="head"><p>I1 I2 I3</p></th>
<th class="head"><p>I4</p></th>
<th class="head"><p>I5</p></th>
<th class="head"><p>I6</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>PRoT SPM Code</p></td>
<td rowspan="4"><p>A_RO</p></td>
<td rowspan="2"><p>P_RO</p></td>
<td rowspan="2"><p>P_RO</p></td>
<td><p>P_RO</p></td>
</tr>
<tr class="row-odd"><td><p>PRoT Service Code</p></td>
<td rowspan="2"><p>A_ROPXN</p></td>
</tr>
<tr class="row-even"><td><p>Active Partition
Code</p></td>
<td><p>A_RO</p></td>
<td><p>A_ROPXN</p></td>
</tr>
<tr class="row-odd"><td><p>SPRTL Code</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">X</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">X</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">X</span></code></p></td>
</tr>
<tr class="row-even"><td><p>PRoT SPM RO</p></td>
<td rowspan="4"><p>A_ROXN</p></td>
<td rowspan="2"><p>P_ROXN</p></td>
<td rowspan="2"><p>P_ROXN</p></td>
<td><p>P_ROXN</p></td>
</tr>
<tr class="row-odd"><td><p>PRoT Service RO</p></td>
<td rowspan="2"><p>A_ROXN</p></td>
</tr>
<tr class="row-even"><td><p>Active Partition
RO</p></td>
<td><p>A_ROXN</p></td>
<td><p>A_ROXN</p></td>
</tr>
<tr class="row-odd"><td><p>SPRTL RO</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">X</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">X</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">X</span></code></p></td>
</tr>
<tr class="row-even"><td><p>PRoT SPM RW</p></td>
<td rowspan="2"><p>P_RWXN</p></td>
<td rowspan="2"><p>P_RWXN</p></td>
<td rowspan="2"><p>P_RWXN</p></td>
<td><p>P_RWXN</p></td>
</tr>
<tr class="row-odd"><td><p>PRoT Service RW</p></td>
<td rowspan="2"><p>A_RWXN</p></td>
</tr>
<tr class="row-even"><td><p>Active Partition
RW</p></td>
<td><p>A_RWXN</p></td>
<td><p>A_RWXN</p></td>
<td><p>A_RWXN</p></td>
</tr>
<tr class="row-odd"><td><p>SPRTL RW [5]</p></td>
<td><p>A_RWXN + 1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">X</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">X</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">X</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Partition Peri</p></td>
<td><p>A_RWXN + n</p></td>
<td><p>A_RWXN + n</p></td>
<td><p>A_RWXN + n</p></td>
<td><p>A_RWXN + n</p></td>
</tr>
<tr class="row-odd"><td><p>Total Numbers</p></td>
<td><p>[1]</p></td>
<td><p>[2]</p></td>
<td><p>[3]</p></td>
<td><p>[4]</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>Total number = A_RO + A_ROXN + P_RWXN + A_RWXN + (1 + n)A_RWXN, while
n equals the maximum peripheral numbers needed by one partition. This is
the configuration chosen by the reference implementation.</p></li>
<li><p>Total number = P_RO + P_ROXN + P_RWXN + A_RO + A_ROXN + (1 + n)A_RWXN,
the minimal result is <cite>6</cite>, and SPRTL can not be applied.</p></li>
<li><p>Total number = P_RO + P_ROXN + P_RWXN + A_ROXN + (1 + n)A_RWXN +
A_ROPXN, the minimal result is <cite>6</cite>, SPRTL can not be applied, and PXN
is required.</p></li>
<li><p>Total number = P_RO + P_ROXN + P_RWXN + A_ROXN + (1 + n)A_RWXN +
A_ROPXN, the minimal result is <cite>6</cite>, SPRTL can not be applied, and PXN
is required. To comply with this rule, the PSA RoT Service needs
to be implemented as Secure Partitions.</p></li>
<li><p>This data belongs to SPRTL RW but it is set as Read-Only and only SPM
can update this region with the activate partition’s metadata for
implementing functions with owner SP’s context, such as heap functions.
This region can be skipped if there is no metadata required (such as no
heap functionalities required).</p></li>
</ol>
<p>The memory-mapped regions for peripherals have different memory access
attributes in general, they are standalone regions in MPU even their
attributes covers ‘A_RWXN’.</p>
</div>
</div>
<div class="section" id="default-access-rules">
<h3>Default access rules<a class="headerlink" href="#default-access-rules" title="Permalink to this heading"></a></h3>
<p>Hardware protection components MAY have the capability to collect regions
not explicitly configured in static or runtime settings, and then apply
default access rules to the collected. Furthermore, one default rule can be
applied to multiple non-contiguous regions which makes them share a common
boundary. This operation sets up a standalone ‘region’ as same as other
explicitly configured regions. And it doesn’t affect the analysis summary
above - just be aware that some regions listed in the table MAY not be
explicitly configured.</p>
<p>Take the MPU as an example, MPU can assign a default privileged access
attribute to the regions (SPM and PRoT regions e.g.) not explicitly configured.
This feature can reduce required MPU regions and ease the programming because
regions can be put non-address-contiguous and skip the explicit configuration.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When this default access rules mechanism is applied, the
non-explicitly-expressed regions must be reviewed to ensure the isolation
boundaries are set properly.</p>
</div>
</div>
<div class="section" id="interfaces">
<h3>Interfaces<a class="headerlink" href="#interfaces" title="Permalink to this heading"></a></h3>
<p>The isolation implementation is based on the HAL framework. The SPM relies on
the HAL API to perform the necessary isolation related operations.</p>
<p>The requirement the software need to do are these:</p>
<ul class="simple">
<li><p>Create enough isolation protection at the early stage of system booting, just
need to focus on the SPM domain.</p></li>
<li><p>Create an isolation domain between secure and non-secure before the jump to
the non-secure world.</p></li>
<li><p>Create an isolation domain for each Secure Partition after the Secure
Partition is loaded and before jumping to its entry point. The isolation
domain should cover all the assets of the Secure Partition, include all its
memory, interrupts, and peripherals.</p></li>
<li><p>Switch isolation domains when scheduling different Secure Partitions.</p></li>
<li><p>It is also a requirement that the platform needs to help to check if the
caller of the PSA APIs is permitted to access some memory ranges.</p></li>
</ul>
<p>The design document
<a class="reference internal" href="software/hardware_abstraction_layer.html"><span class="doc">TF-M Hardware Abstraction Layer</span></a>
gives a detail design, include the platform initialization, isolation
interfaces. Please refer to it for more detail.</p>
</div>
<div class="section" id="appendix">
<h3>Appendix<a class="headerlink" href="#appendix" title="Permalink to this heading"></a></h3>
<div class="line-block">
<div class="line"><a class="reference external" href="https://www.arm.com/architecture/security-features/platform-security">Firmware Framework for M (FF-M)</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference external" href="https://developer.arm.com/documentation/aes0039/latest">FF-M Extensions (FF-M 1.1)</a></div>
</div>
<div class="line-block">
<div class="line"><a class="reference external" href="https://www.arm.com/architecture/security-features/platform-security">Trusted Base System Architecture for M (TBSA-M)</a></div>
</div>
<hr class="docutils" />
<p><em>Copyright (c) 2020-2022, Arm Limited. All rights reserved.</em></p>
</div>
</div>
</div>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p></p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>